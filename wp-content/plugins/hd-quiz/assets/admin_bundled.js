(()=>{var _=async function(e="",t={}){let i=await r(e,t),n=null;if(ajaxurl&&(n=ajaxurl),ajaxurl===null){console.error("No ajax url found");return}let a=new FormData;a.append("action",e);for(let[f,h]of Object.entries(t))a.append(f,h);let s=document.getElementById("hd_wpnonce").value;a.append("HD_NONCE",s);let l=await fetch(n,{method:"POST",credentials:"same-origin",body:a});return l=await l.json(),l;async function r(f,h){let v="";for(let p in h)v+="&"+p+"="+h[p];return`action=${f}`+v}function m(f){console.log(f)}};var w={get:async function(e,t=null){console.log("getting the dashboard");let i=await w.getData();await w.render(i),_hd.init();let n=document.getElementById("hd_save");n.setAttribute("tabindex",0),document.getElementById("hdq_quiz_name").addEventListener("keyup",function(s){s.key==="Enter"&&n.click()});let a=document.getElementsByClassName("hdq_quiz_item");for(let s=0;s<a.length;s++)a[s].addEventListener("click",function(l){l.target.tagName=="CODE"&&l.preventDefault()})},getData:async function(){return await _("hdq_get_view_dashboard",{})},render:async function(e){document.getElementById("hdq_content").innerHTML=e.html,document.getElementById("hdq_content").scrollTo(0,0),document.getElementById("hdq_loading").classList.remove("active")}};var d={get:async function(e,t=null){console.log("getting the quiz ID "+t);let i=await d.getData(t);await d.render(i)},getData:async function(e){let t=1;e[1]&&(t=e[1]);let i={quiz_id:e[0],paged:t};return console.log(i),await _("hdq_get_view_quiz",i)},render:async function(e){document.getElementById("hdq_content").innerHTML=e.html,document.getElementById("hdq_content").scrollTo(0,0),document.getElementById("hdq_loading").classList.remove("active"),d.search.init(),_hd.init(),HDQ.form.createEditors(),HDQ.form.tabs(),document.getElementById("hdq_copy_shortcode").addEventListener("click",function(){let n=this;if(n.classList.contains("active"))return;n.classList.add("active");let a=n.innerText;navigator.clipboard.writeText(n.innerText),n.innerText="copied to clipboard",setTimeout(function(){n.innerText=a,n.classList.remove("active")},3e3)}),e.type==="personality"&&d.personality.init(),HDQ.sort.init(),d.question_order.init();let t=document.getElementById("hd_delete_quiz");if(!t)return;t.addEventListener("click",async function(){confirm("You are about to delete this entire quiz and all attached questions. Continue?")&&i(this)});async function i(n){let a={quiz_id:parseInt(n.getAttribute("data-quiz"))},s=await _("hdq_delete_quiz",a);console.log(s),HDQ.router.views.dashboard.get(null,[])}return e},search:{init:function(){if(document.getElementsByClassName("hdq_quiz_item").length<=25)return;document.getElementById("hdq_quiz_tabs_labels").insertAdjacentHTML("beforeend",'<div id = "hdq_quiz_tabs_search_wrapper"><span class="hd_tooltip_item">?<span class="hd_tooltip"><div class="hd_tooltip_content">Press Enter to confirm your search for question titles. This feature is currently experimental.</div></span></span> <input type = "search" placeholder = "search..." id = "hdq_questions_search"/></div>'),document.getElementById("hdq_questions_search").addEventListener("keyup",d.search.filter),document.getElementById("hdq_questions_search").addEventListener("click",function(){this.value!==""&&(this.value="",d.search.clear())})},filter:function(e){if(e.keyCode!==13)return;let t=document.getElementById("hdq_questions_search");if(t.value.length===0){d.search.clear();return}if(t.value.length>=3){let i=t.value.toLocaleUpperCase(),n=document.getElementsByClassName("hdq_quiz_item");for(let a=0;a<n.length;a++)n[a].getElementsByTagName("span")[1].innerText.toLocaleUpperCase().includes(i)?n[a].classList.remove("hdq_hidden"):n[a].classList.add("hdq_hidden")}},clear:function(){let e=document.getElementsByClassName("hdq_quiz_item");for(let t=0;t<e.length;t++)e[t].classList.remove("hdq_hidden")}},question_order:{init:function(){_hd.validate.field.hdq_field_question_order=d.question_order.validate},validate:async function(e){return{value:await d.question_order.getData(e),status:!0}},getData:async function(){let e=document.getElementsByClassName("hdq_quiz_question"),t=[];for(let i=0;i<e.length;i++){let n=parseInt(e[i].getAttribute("data-id"));t.push(n)}return t}},personality:{saved:{hasAdded:!1,hasSaved:!1},init:function(){_hd.validate.field.hdq_field_personality_results=d.personality.validate,document.getElementById("hdq_add_new_personality_outcome").addEventListener("click",function(){d.personality.create()}),d.personality.remove.init(),document.getElementById("hd_save").addEventListener("click",function(e){d.personality.saved.hasSaved=!0}),document.getElementById("hdq_add_new_quiz").addEventListener("click",function(e){d.personality.saved.hasAdded&&!d.personality.saved.hasSaved&&document.getElementsByClassName("hdq_outcome_label").length>1&&(e.preventDefault(),confirm("You have added a new outcome but have not saved. Contunue to adding a new question?")&&(window.location=this.href))})},remove:{init:function(){let e=document.getElementsByClassName("hdq_remove_outcome");for(let t=0;t<e.length;t++)e[t].addEventListener("click",function(){this.parentElement.remove()})}},validate:async function(e){await tinyMCE.triggerSave();let t=e.getAttribute("id"),i=[],n=e.getElementsByClassName("hdq_outcome_label"),a=e.getElementsByClassName("hd_editor_input");for(let r=0;r<n.length;r++)i.push({label:n[r].value,id:n[r].value.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"").replaceAll(" ","_").toLowerCase()+""+r,content:a[r].value});let s=!0;for(let r=0;r<i.length;r++)i[r].label==""?(s=!1,n[r].classList.add("hd_error")):n[r].classList.remove("hd_error");return{value:i,status:s}},create:function(){d.personality.saved.hasAdded=!0;let e=document.getElementById("personality_results").getElementsByClassName("hd_input_item").length;e=String.fromCharCode(e+65);let t=`<div class="hd_input_item">
	<div class="hdq_remove_outcome" title="Remove this outcome">x</div>
	<label class="hd_input_label" for="hdq_result_${e}"><span class="hd_required_icon"></span> Outcome title <span class="hd_tooltip_item">?<span class="hd_tooltip"><div class="hd_tooltip_content">NOTE: If you rename this outcome, you will need to re-edit your questions to set the correct answer.</div></span></span></label>
	<input type="text" data-type="text" data-required="required" class="hd_input hdq_outcome_label" id="hdq_result_${e}" value="Result ${e}" placeholder="Result title..." data-tab="Results" />

	<div id="wp-hdq_result_content_result_${e}-wrap" class="wp-core-ui wp-editor-wrap tmce-active">
		<link rel="stylesheet" id="dashicons-css" href="https://hdquiz.local/wp-includes/css/dashicons.min.css?ver=6.6.2" media="all" />
		<link rel="stylesheet" id="editor-buttons-css" href="https://hdquiz.local/wp-includes/css/editor.min.css?ver=6.6.2" media="all" />
		<div id="wp-hdq_result_content_result_${e}-editor-tools" class="wp-editor-tools hide-if-no-js">
			<div id="wp-hdq_result_content_result_${e}-media-buttons" class="wp-media-buttons">
				<button type="button" id="insert-media-button" class="button insert-media add_media" data-editor="hdq_result_content_result_${e}"><span class="wp-media-buttons-icon"></span> Add Media</button>
			</div>
			<div class="wp-editor-tabs">
				<button type="button" id="hdq_result_content_result_${e}-tmce" class="wp-switch-editor switch-tmce" data-wp-editor-id="hdq_result_content_result_${e}">Visual</button>
				<button type="button" id="hdq_result_content_result_${e}-html" class="wp-switch-editor switch-html" data-wp-editor-id="hdq_result_content_result_${e}">Text</button>
			</div>
		</div>
		<div id="wp-hdq_result_content_result_${e}-editor-container" class="wp-editor-container">
			<div id="qt_hdq_result_content_result_${e}_toolbar" class="quicktags-toolbar hide-if-no-js"></div>
			<textarea
				class="hd_input hd_editor_input wp-editor-area"
				style="height: 240px"
				autocomplete="off"
				cols="40"
				name="hdq_result_content_result_${e}"
				id="hdq_result_content_result_${e}"
				data-type="editor"
				data-lt-tmp-id="lt-8142"
				spellcheck="false"
				data-gramm="false"></textarea>
		</div>
	</div>
</div>`;document.getElementById("personality_results").insertAdjacentHTML("beforeend",t),HDQ.form.createEditors(),d.personality.remove.init()}}};var c={get:async function(e,t=null){console.log("getting the question ID "+t[1]);let i=await c.getData(t);await c.render(i)},getData:async function(e){let t={quiz_id:parseInt(e[0]),question_id:parseInt(e[1])};return await _("hdq_get_view_question",t)},render:async function(e){document.getElementById("hdq_content").innerHTML=e.html,document.getElementById("hdq_content").scrollTo(0,0),document.getElementById("hdq_loading").classList.remove("active"),_hd.init(),HDQ.form.createEditors(),HDQ.form.tabs(),c.answers.data.question_id=e.question_id,c.answers.data.quiz_id=e.quiz_id,c.answers.init();let t=document.getElementById("hd_delete_question");if(!t)return;t.addEventListener("click",async function(){confirm("You are about to delete this question. Continue?")&&i(this)});async function i(n){let a={quiz_id:parseInt(n.getAttribute("data-quiz")),question_id:parseInt(n.getAttribute("data-id"))},s=await _("hdq_delete_question",a);HDQ.router.views.quiz.get(s.action.data,s.action.data2);let l={quiz_id:s.action.data2};history.pushState(l,"")}},update:function(e){document.getElementById("question_id").value=parseInt(e[0]),document.getElementById("hd_delete_question").setAttribute("data-id",parseInt(e[0]))},answers:{data:{answers:[],question_id:0,quiz_id:0,defaults:{value:"",image:"",imageURL:"",selected:""}},init:function(){c.answers.onChangeQuestionType(),c.fieldAnswers.init()},onChangeQuestionType:function(){let e=document.getElementById("question_type");e&&(e.addEventListener("change",async function(){c.answers.changeQuestionType(this)}),setTimeout(function(){e.options[0].selected&&(e.options[1].selected=!0);let t=new Event("change");e.dispatchEvent(t)},10))},changeQuestionType:async function(e){document.getElementById("hdq_loading").classList.add("active");let t=document.getElementById("question_type"),i=e.value;if(i===""||i===null){t.options[1].selected=!0;let a=new Event("change");t.dispatchEvent(a);return}let n={question_type:i,question_id:c.answers.data.question_id,quiz_id:c.answers.data.quiz_id};c.answers.data.answers=await c.answers.getAnswerData(),n=await _("hdq_get_question_type",n),n.status&&n.status==="success"?(document.getElementById("question_answers").innerHTML=n.html,n.action&&n.action.name&&(console.log("running action "+n.action.name),HDQ[n.action.name]()),c.answers.setAnswerData(c.answers),document.getElementById("hdq_loading").classList.remove("active")):console.log(n)},getAnswerData:async function(e=document.getElementById("question_answers")){let t=e.getElementsByClassName("hdq_answer_row");if(t.length===0)return[[],!1];let i=[];for(let a=0;a<t.length;a++){let s=JSON.parse(JSON.stringify(c.answers.data.defaults)),l=t[a].getElementsByClassName("hdq_answer_item_input");for(let r=0;r<l.length;r++){let m=l[r].getAttribute("data-answer-type");l[r].getAttribute("type")=="checkbox"?l[r].checked&&(s[m]="yes"):l[r].getAttribute("data-value")?s[m]=l[r].getAttribute("data-value"):s[m]=l[r].value}i.push(s)}let n=[];for(let a=0;a<i.length;a++)i[a].value&&i[a].value!==""&&n.push(i[a]);return[n,!0]},setAnswerData:async function(){let e=c.answers.data.answers[0];if(e.length===0)return;let t=document.getElementsByClassName("hdq_answer_row");for(let i=0;i<t.length;i++){let n=t[i].getElementsByClassName("hdq_answer_item_input");for(let a=0;a<n.length;a++){let s=n[a].getAttribute("data-answer-type");e[i]&&e[i][s]&&(n[a].getAttribute("type")=="checkbox"?n[a].checked=!0:n[a].getAttribute("data-value")?(n[a].setAttribute("data-value",e[i][s]),s==="image"&&(n[a].innerHTML="",n[a].insertAdjacentElement("beforeend",e[i].imageURL),n[a].nextElementSibling.classList.add("active"))):n[a].value=e[i][s])}}}},fieldAnswers:{init:function(){_hd.validate.field.hdq_field_answers=c.fieldAnswers.validate},validate:async function(e){let t=!0,i=await c.answers.getAnswerData(e),n=i[0];return i[1]&&n.length==0&&(t=!1),{value:n,status:t}}}};var b={dashboard:w,quiz:d,question:c,reload:{get:function(e){location.reload(!0)}}};var y={views:b,init:async function(){await y.getView(),window.addEventListener("hashchange",async function(){y.getView()})},getHash:async function(){let e=window.location.hash;return e.length==0&&(e="#/dashboard"),e},getView:async function(e=null){let t=await y.getHash();return t=t.replaceAll("#/",""),e=t.split("/"),e.shift(),t=t.split("/")[0],b[t]?y.views[t].get(t,e):console.error("HD Quiz: View "+t+" could not be found"),document.getElementById("hdq_loading").classList.add("active"),t}};var L={tabs:function(){let e=document.getElementsByClassName("hdq_quiz_tab");for(let i=0;i<e.length;i++)e[i].addEventListener("click",function(){t(),this.classList.add("hdq_quiz_tab_active");let n=this.getAttribute("data-id");document.getElementById(n).classList.add("hdq_tab_content_active")});function t(){let i=document.getElementsByClassName("hdq_quiz_tab_active");for(;i.length>0;)i[0].classList.remove("hdq_quiz_tab_active");let n=document.getElementsByClassName("hdq_tab_content_active");for(;n.length>0;)n[0].classList.remove("hdq_tab_content_active")}},createEditors:function(){let e=document.getElementsByClassName("hd_editor_input");for(let i=0;i<e.length;i++){let n=e[i].getAttribute("id");tinyMCE.execCommand("mceRemoveEditor",!1,n)}setTimeout(t,1600);function t(){tinyMCE.init({mode:"textareas",relative_urls:!1,remove_script_host:!1,convert_urls:!1,browser_spellcheck:!0,entity_encoding:"raw",keep_styles:!1,resize:!0,content_style:"body { height: 100vh; min-height: 120px }",menubar:!1,branding:!1,wpeditimage_html5_captions:!0,plugins:"charmap,colorpicker,hr,lists,media,paste,tabfocus,textcolor,wordpress,wpautoresize,wpeditimage,wpemoji,wpgallery,wplink,wpdialogs,wptextpattern,wpview",wpautop:!0,indent:!1,toolbar1:"formatselect,bold,italic,bullist,numlist,blockquote,alignleft,aligncenter,alignright,link,dfw,wp_adv",toolbar2:"strikethrough,hr,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",toolbar3:"",toolbar4:"",tabfocus_elements:"content-html,save-post",wp_autoresize_on:!1,add_unload_trigger:!1,block_formats:"Paragraph=p;Heading 2=h2;Heading 3=h3;Heading 4=h4;Code=code"})}}};var g={FFhasInit:!1,init:function(){g.FFhasInit||(g.FFhasInit=!0,/Firefox\/\d+[\d\.]*/.test(navigator.userAgent)&&typeof window.DragEvent=="function"&&typeof window.addEventListener=="function"&&function(){var t,i,n,a,s,l,r,m,f,h;function v(o){t=o.clientX,i=o.clientY,n=o.pageX,a=o.pageY,s=o.offsetX,l=o.offsetY,r=o.screenX,m=o.screenY,f=o.layerX,h=o.layerY}function p(o){o._ffix_cx=t,o._ffix_cy=i,o._ffix_px=n,o._ffix_py=a,o._ffix_ox=s,o._ffix_oy=l,o._ffix_sx=r,o._ffix_sy=m,o._ffix_lx=f,o._ffix_ly=h}window.addEventListener("mousemove",v,!0),window.addEventListener("dragover",v,!0),window.addEventListener("dragstart",p,!0),window.addEventListener("drag",p,!0),window.addEventListener("dragend",p,!0);var x=Object.getOwnPropertyDescriptors(window.MouseEvent.prototype),I=Object.getOwnPropertyDescriptors(window.UIEvent.prototype);function u(o,E){return function(){return x[o]&&x[o].get.call(this)||Number(this[E])||0}}function B(o,E){return function(){return this.type==="dragover"&&I[o]?I[o].get.call(this):Number(this[E])||0}}Object.defineProperties(window.DragEvent.prototype,{clientX:{get:u("clientX","_ffix_cx")},clientY:{get:u("clientY","_ffix_cy")},pageX:{get:u("pageX","_ffix_px")},pageY:{get:u("pageY","_ffix_py")},offsetX:{get:u("offsetX","_ffix_ox")},offsetY:{get:u("offsetY","_ffix_oy")},screenX:{get:u("screenX","_ffix_sx")},screenY:{get:u("screenY","_ffix_sy")},x:{get:u("x","_ffix_cx")},y:{get:u("y","_ffix_cy")},layerX:{get:B("layerX","_ffix_lx")},layerY:{get:B("layerY","_ffix_ly")}})}());let e=document.getElementById("hdq_questions_list").getElementsByClassName("hdq_quiz_question");for(let t=0;t<e.length;t++)g.enableDragItem(e[t])},enableDragItem:function(e){e.setAttribute("draggable",!0),e.ondrag=g.handleDrag,e.ondragend=g.handleDrop},handleDrag:function(e){let t=e.target,i=e.clientX,n=e.clientY,a=[document.getElementById("hdq_questions_list")];t.classList.add("drag-sort-active");let s=document.elementFromPoint(i,n)===null?t:document.elementFromPoint(i,n);if(s!==null&&s.getAttribute("draggable")=="true")for(let l=0;l<a.length;l++)s!==null&&a[l]===s.parentNode&&(s=s!==t.nextSibling?s:s.nextSibling,a[l].insertBefore(t,s))},handleDrop:function(e){e.target.classList.remove("drag-sort-active"),document.getElementById("hdq_questions_list").classList.add("hderp")}};var q={init:async function(){console.log("HD Quiz v"+HDQ_VERSION+" init");async function e(){await q.router.init()}await e(),q.form.createEditors()},router:y,form:L,sort:g,images:function(){_hd.images.init()},reload:function(e){let t=e.getAttribute("href");window.location.href.includes(t)&&window.location.reload()}};q.init();window.HDQ=q;})();
//# sourceMappingURL=admin_bundled.js.map
