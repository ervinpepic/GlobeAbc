(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1197:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(126),a=n(2),l=n(25),i=n(10),o=n.n(i),s=n(8),u=n(1),b=(n(663),n(4)),f=n(6),d=n.n(f),m=n(5),p=n(366),O=n(29),j=n(30),v=n(81),y=n(298),w=n(42),g=n(350),_=n(12),h=n(463),E=n(34),S=n(50),k=n(21);function N(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",c=n.toStringTag||"@@toStringTag";function a(n,r,c,a){var o=r&&r.prototype instanceof i?r:i,s=Object.create(o.prototype);return C(s,"_invoke",function(n,r,c){var a,i,o,s=0,u=c||[],b=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,o=e,f.n=n,l}};function d(n,r){for(i=n,o=r,t=0;!b&&s&&!c&&t<u.length;t++){var c,a=u[t],d=f.p,m=a[2];n>3?(c=m===r)&&(o=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((c=n<2&&d<a[1])?(i=0,f.v=r,f.n=a[1]):d<m&&(c=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,f.n=m,i=0))}if(c||n>1)return l;throw b=!0,r}return function(c,u,m){if(s>1)throw TypeError("Generator is already running");for(b&&1===u&&d(u,m),i=u,o=m;(t=i<2?e:o)||!b;){a||(i?i<3?(i>1&&(f.n=-1),d(i,o)):f.n=o:f.v=o);try{if(s=2,a){if(i||(c="next"),t=a[c]){if(!(t=t.call(a,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(o=TypeError("The iterator does not provide a '"+c+"' method"),i=1);a=e}else if((t=(b=f.n<0)?o:n.call(r,f))!==l)break}catch(t){a=e,i=1,o=t}finally{s=1}}return{value:t,done:b}}}(n,c,a),!0),s}var l={};function i(){}function o(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(C(t={},r,(function(){return this})),t),b=s.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,C(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e}return o.prototype=s,C(b,"constructor",s),C(s,"constructor",o),o.displayName="GeneratorFunction",C(s,c,"GeneratorFunction"),C(b),C(b,c,"Generator"),C(b,r,(function(){return this})),C(b,"toString",(function(){return"[object Generator]"})),(N=function(){return{w:a,m:f}})()}function C(e,t,n,r){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}(C=function(e,t,n,r){if(t)c?c(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){C(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}})(e,t,n,r)}function P(e,t,n,r,c,a,l){try{var i=e[a](l),o=i.value}catch(e){return void n(e)}i.done?t(o):Promise.resolve(o).then(r,c)}function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){var t=Object(c.useParams)(),n=t.id,a=t.builder,l=e.query,i=e.isOpen,f=e.setModalOpenState,m=e.hasCheckoutStep,w=e.funnelId,C=void 0===w?n:w,T=l.importType,I="wc_checkout"===T?"funnel":T,D=j.a.getAddStepData(),F=Object(O.a)(),B=F.addStep,L=F.addSubStep,z=F.endAddStep,U=F.updateFunnelViewLink,M=F.setCountData,R=F.fetch,q=Object(v.a)(),G=q.setActiveGroup,J=q.setActiveSubFilter,$=(0,Object(y.a)().getActiveGroup)(),H=Object(E.a)().getStatus,Q=Object(S.a)().updateStatus,Y=H(),W=x(Object(r.useState)(null),2),K=W[0],V=W[1],X=l.path.startsWith("/store-checkout"),Z=(0,Object(k.a)().getGlobalCheckout)(),ee=("object"===A(Z)?Z:{}).funnel_id,te=void 0===ee?0:ee,ne=!!a||!!I,re=function(){f(!1),K&&V(null)};Object(r.useEffect)((function(){return function(){z()}}),[]),Object(r.useEffect)((function(){return D&&"type"in D&&(V(D),f(!0)),function(){re()}}),[D]);var ce=function(e,t){var n=K.is_substep,r=K.type,c=K.parent_id;e.status&&"data"in e&&(n?e.data&&(L(e.data,r,parseInt(c),!!t),Object(_.k)({},"".concat(Object(b.kb)()?"/store-checkout/bump":"/funnel-bump","/").concat(e.data.id).concat(t?"/design":"/import","&funnel_id=").concat(C))):B(e.data))},ae=x(Object(r.useState)(!1),2),le=ae[0],ie=ae[1],oe=x(Object(r.useState)(null),2),se=oe[0],ue=oe[1],be=x(Object(r.useState)(!1),2),fe=be[0],de=be[1],me=function(){var e,t=(e=N().m((function e(t){var n,r,c,a,l,i,s,u,f,d,m,p,O,j,v,y;return N().w((function(e){for(;;)switch(e.n){case 0:if(!le){e.n=1;break}return e.a(2);case 1:return de(!0),ie(!0),n=K.type,r=void 0===n?"":n,c=K.parent_id,a=void 0===c?0:c,l=K.is_substep,i=void 0!==l&&l,s=t.copyFrom,u=void 0===s?{}:s,f=t.title,d=void 0===f?"":f,(m=u&&u.hasOwnProperty("key")?u.key:0)<1&&(m=u&&u.hasOwnProperty("id")?u.id:0),p="",i&&parseInt(a)>0&&(p="".concat(a,"/substeps/")),Object(b.kb)()&&"wc_order_bump"===r&&(p="".concat(a,"/substeps/")),O="",O="offer"==r?"/funnel-upsell/".concat(a,"/offers"):"/funnels/".concat(C,"/steps/").concat(p),Object(b.kb)()&&(O="/store-checkout/".concat(C,"/step/").concat(p)),j={title:d,inherit_from:m,type:r},e.p=2,e.n=3,o()({method:"POST",path:Object(b.y)(O),data:j});case 3:(v=e.v).hasOwnProperty("status")&&v.status?ye():ue(!1),v.hasOwnProperty("status")&&v.status&&ce(v,m),U(),v.hasOwnProperty("count_data")&&M(v.count_data),p&&"wc_order_bump"===r&&!Y.is_orderbump&&Q({is_orderbump:!0}),ie(!1),pe(!1),e.n=5;break;case 4:e.p=4,y=e.v,console.log("Error While Creating Step: "),console.log(y),ue(!1),U(),ie(!1),pe(!1);case 5:return e.a(2)}}),e,null,[[2,4]])})),function(){var t=this,n=arguments;return new Promise((function(r,c){var a=e.apply(t,n);function l(e){P(a,r,c,l,i,"next",e)}function i(e){P(a,r,c,l,i,"throw",e)}l(void 0)}))});return function(e){return t.apply(this,arguments)}}(),pe=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=function(){V(null),z(),de(!1),ue(null),f(!1)};if(e)var n=setTimeout((function(){clearTimeout(n),t()}),2e3);else t()},Oe=(K||{}).is_substep,je=!fe&&K&&!(void 0!==Oe&&Oe)&&Object(r.createElement)(s.Button,{icon:"arrow-left-alt wffn-icon",onClick:function(){return V(null)}}),ve=Object(r.createElement)(r.Fragment,null,je,K&&"wc_order_bump"===K.type?Object(u.__)("Add Order Bump","funnel-builder"):K&&"popup_title"in K?K.popup_title:"funnel"===I?X?Object(u.__)("Create Store Checkout","funnel-builder"):Object(u.__)("Funnel Templates","funnel-builder"):Object(u.__)("Add Step","funnel-builder"));Object(r.useEffect)((function(){K||!i&&!ne||"upsell"!==$&&(!I&&!X||a?a||G("landing"):"step"===I?G("wc_checkout"):"funnel"===I&&G("funnel"))}),[i,ne]);var ye=function(){delete l.importType,delete l.group,G("funnel"),J(!1),re(),Object(_.k)({},Object(_.g)(),l)};return Object(r.createElement)(r.Fragment,null,(i||ne)&&Object(r.createElement)(s.Modal,{title:ve,onRequestClose:function(){K&&pe(),ye(),Object(b.kb)()?Object(_.k)({},"/store-checkout"):Object(_.k)({},"/funnels/".concat(C))},className:d()("bwf-admin-modal",{"bwf-admin-modal-full-screen bwf-add-step-modal":!K,"bwf-admin-modal-squeezy bwf-modal-overflow-visible":K}),shouldCloseOnClickOutside:K&&!le,overlayClassName:"wffn_step_template_modal"},!fe&&!K&&I&&("funnel"===I?Object(r.createElement)(h.default,{onImportComplete:function(){ye(),X?(R(parseInt(te)),Object(_.k)({},"/store-checkout")):(R(parseInt(C)),Object(_.k)({},"/funnels/".concat(C)))},isStoreCheckout:X,storeCheckoutId:te}):Object(r.createElement)(g.a,{onImportComplete:function(){ye(),X?(R(parseInt(te)),Object(_.k)({},"/store-checkout")):(R(parseInt(C)),Object(_.k)({},"/funnels/".concat(C)))},isStoreCheckout:X,storeCheckoutId:te,hasCheckoutStep:m})),K&&Object(r.createElement)(p.a,{step:K,requestCreateStep:me,onRequestClose:re,onCreationScreen:fe,clearAndCloseEverything:pe,creationSuccess:se,isBusy:le})))},D=n(20);function F(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",c=n.toStringTag||"@@toStringTag";function a(n,r,c,a){var o=r&&r.prototype instanceof i?r:i,s=Object.create(o.prototype);return B(s,"_invoke",function(n,r,c){var a,i,o,s=0,u=c||[],b=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,o=e,f.n=n,l}};function d(n,r){for(i=n,o=r,t=0;!b&&s&&!c&&t<u.length;t++){var c,a=u[t],d=f.p,m=a[2];n>3?(c=m===r)&&(o=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((c=n<2&&d<a[1])?(i=0,f.v=r,f.n=a[1]):d<m&&(c=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,f.n=m,i=0))}if(c||n>1)return l;throw b=!0,r}return function(c,u,m){if(s>1)throw TypeError("Generator is already running");for(b&&1===u&&d(u,m),i=u,o=m;(t=i<2?e:o)||!b;){a||(i?i<3?(i>1&&(f.n=-1),d(i,o)):f.n=o:f.v=o);try{if(s=2,a){if(i||(c="next"),t=a[c]){if(!(t=t.call(a,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(o=TypeError("The iterator does not provide a '"+c+"' method"),i=1);a=e}else if((t=(b=f.n<0)?o:n.call(r,f))!==l)break}catch(t){a=e,i=1,o=t}finally{s=1}}return{value:t,done:b}}}(n,c,a),!0),s}var l={};function i(){}function o(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(B(t={},r,(function(){return this})),t),b=s.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,B(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e}return o.prototype=s,B(b,"constructor",s),B(s,"constructor",o),o.displayName="GeneratorFunction",B(s,c,"GeneratorFunction"),B(b),B(b,c,"Generator"),B(b,r,(function(){return this})),B(b,"toString",(function(){return"[object Generator]"})),(F=function(){return{w:a,m:f}})()}function B(e,t,n,r){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}(B=function(e,t,n,r){if(t)c?c(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){B(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}})(e,t,n,r)}function L(e,t,n,r,c,a,l){try{var i=e[a](l),o=i.value}catch(e){return void n(e)}i.done?t(o):Promise.resolve(o).then(r,c)}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var M=function(e){var t=e.funnelId,n=void 0===t?0:t,c=Object(D.c)().showSnackbar,a=j.a.getDuplicateStepData(),l=a.step,i=a.stepPos,f=a.shouldDuplicate,d=a.substepOf,m=void 0===d?null:d,p=z(Object(r.useState)(!1),2),v=p[0],y=p[1],g=z(Object(r.useState)(null),2),_=g[0],h=g[1],E=z(Object(r.useState)(null),2),S=E[0],k=E[1],N=Object(O.a)(),C=N.addStep,P=N.addSubStep,A=N.endDuplicateStep,x=N.setCountData,T=function(){var e=setTimeout((function(){A(),clearTimeout(e)}),2e3)},I=function(){var e,t=(e=F().m((function e(){var t,r,a,s,f;return F().w((function(e){for(;;)switch(e.n){case 0:return y(!0),e.p=1,r=(t=m&&"id"in m)?"".concat(m.id,"/substeps/"):"",a=Object(b.kb)()&&t?"/store-checkout/".concat(n,"/step/").concat(r):"/funnels/".concat(n,"/steps/").concat(r),"offer"===l.type&&t&&(a="/funnel-upsell/".concat(m.id,"/offers/")),e.n=2,o()({method:"POST",path:Object(b.y)(a),data:{duplicate_id:l.id,type:l.type}});case 2:"status"in(s=e.v)&&s.status?(t?P(s.data,l.type,m.id,!0):C(s.data,i),h(null),A(),s.hasOwnProperty("count_data")&&x(s.count_data),c(Object(u.__)("Changes Saved","funnel-builder"))):(k({message:Object(u.__)("There are some technical difficulties while duplicating step. Contact Support","funnel-builder")}),h(!1)),e.n=4;break;case 3:e.p=3,f=e.v,console.log(f),k(f),h(!1);case 4:y(!1),T();case 5:return e.a(2)}}),e,null,[[1,3]])})),function(){var t=this,n=arguments;return new Promise((function(r,c){var a=e.apply(t,n);function l(e){L(a,r,c,l,i,"next",e)}function i(e){L(a,r,c,l,i,"throw",e)}l(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(r.useEffect)((function(){h(null),l&&I()}),[l]),f?Object(r.createElement)(s.Modal,{isDismissible:!1,title:!1===_?Object(u.__)("Failed"):"",onRequestClose:A,className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-admin-modal-no-header"},v&&Object(r.createElement)("div",{className:"bwf-t-center bwf-mt-10"},Object(r.createElement)(w.a,{size:"xxl"}),Object(r.createElement)("div",{className:"bwf-h1 bwf-mt-20"},Object(u.__)("Please wait…","funnel-builder")),Object(r.createElement)("div",{className:"bwf-h4 bwf-h4-grey"},Object(u.__)("We are duplicating step in the funnel","funnel-builder"))),!v&&!0===_&&Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{style:{width:"100px",display:"inline-block"},dangerouslySetInnerHTML:{__html:wffn.icons.success_check}})),!v&&!0===_&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf-h1"}," ",Object(u.__)("Step Duplicated","funnel-builder")))),!v&&!1===_&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:""},Object(r.createElement)("div",{className:"bwf-p"},Object(u.__)("Error: ","funnel-builder")+S&&"message"in S?S.message:Object(u.__)("There are some technical difficulties while duplicating step. Please contact support","funnel-builder")))),!v&&!1===_&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-modal-action".concat(isRtl?" wf_funnel_left_align":" wf_funnel_right_align")},Object(r.createElement)(s.Button,{className:"bwf-modal-confirm-btn",isPrimary:!0,onClick:A},Object(u.__)("OK","funnel-builder"))))):null},R=n(169),q=n(301),G=n(54),J=n(24),$=n(18),H={onMouseEnter:function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.closest(".bwf-f-steps > .bwf-st-c-wrap:not(.bwf-st-c__lite-card)");n&&n.classList.add("is-child-hover")},onMouseLeave:function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.closest(".bwf-f-steps > .bwf-st-c-wrap:not(.bwf-st-c__lite-card)");n&&n.classList.remove("is-child-hover")}};function Q(){return(Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var K=function(e){var t=e.type,n=void 0===t?"upsell":t,c=e.onClick,a=e.modalContent,l=Y(Object(r.useState)(!1),2),i=l[0],s=l[1],f=(Object(O.a)().setShowAddStepModal,Object(v.a)().setActiveGroup),p=Object(J.a)().setStepPromotion;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",Q({className:d()("bwf-st-c-wrap bwf-st-c__lite-card",["bwf-st-lite-".concat(n)])},H),Object(r.createElement)("div",{className:"bwf-st-c bwf-st-c-card-container is-lite-card",onClick:function(){return s(!0)}},Object(r.createElement)("span",{className:"bwf-d-icon-drag",style:{marginTop:"2px"}},Object(r.createElement)(m.a,{icon:"king",color:$.NOTICE_YELLOW,size:20})),Object(r.createElement)("div",{className:"bwf-st-c-title",style:{marginLeft:"-3px",flexDirection:"row"}},Object(r.createElement)("a",{href:"#",onClick:function(e){return e.preventDefault()}},"upsell"===n?Object(u.__)("One Click Upsell Offer","funnel-builder"):Object(u.__)("Order Bump","funnel-builder")),Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap bwf-ml-12"},Object(r.createElement)("div",{className:"bwf-st-c-head bwf-has-chart bwf-st-c-badge-small bwf-st-c-badge-green bwf-cursor-text"},Object(r.createElement)(m.a,{icon:"chart-increase",width:"14",height:"14",color:"#09B29C"}),Object(r.createElement)("span",null,Object(u.__)("Increases average order value","funnel-builder"))))),Object(r.createElement)("div",{className:"bwf-card-controls"},Object(r.createElement)("div",{className:"bwf-card-action",onClick:function(){"upsell"===n?(Object(_.k)({importType:"step"}),f("upsell")):c&&c()},role:"button",tabIndex:"-1"},Object(u.__)("View Templates","funnel-builder")),Object(r.createElement)("div",{className:"bwf-card-action bwf-close-icon",onClick:function(e){var t;e.stopPropagation(),t="/".concat("upsell"===n?"remove-upsell-promotion":"remove-bump-promotion"),p("yes","upsell"===n?"upsell":"bump"),o()({path:Object(b.y)(t),method:"POST",data:{user_id:wffn.current_logged_user}}).then((function(e){e.status||console.log("Failed to remove step promotion.")})).catch((function(e){return console.log(e)}))}},Object(r.createElement)(m.a,{icon:"close",size:12}))))),i&&Object(r.createElement)(G.a,{isOpen:i,onRequestClose:function(){return s(!1)},modalContent:a}))},V=n(31),X=n(55),Z=n(75),ee=n(65),te=n(448),ne=n(22),re=n(88),ce=n(137),ae=n(136),le=n(44),ie=n(64),oe=n(40),se=n(87),ue=n(58),be=(n(664),n(28)),fe={views:{label:Object(u.__)("Views","funnel-builder")},conversions:{label:Object(u.__)("Conversions","funnel-builder")},revenue:{label:Object(u.__)("Revenue","funnel-builder"),isCurrency:!0}},de=function(e){var t=e.items,n=void 0===t?["views","conversions","revenue"]:t,c=e.stats,l=void 0===c?{}:c,i=e.type,o=Object(D.b)().isProFeatureLocked,s=Object(b.A)().formatAmount,f=(0,j.a.getAnalyticsLoading)(),d=Object(b.V)(),m=Object(a.get)(d,"0.modal",{}).primary_action,p=function(e){return!o&&f?Object(r.createElement)("div",{key:e,className:"bwf-funnel-step-analytics__item"},Object(r.createElement)(be.a,{h:12,w:24,ml:"auto",mr:"auto"}),Object(r.createElement)(be.a,{h:12,w:60,mt:4,ml:"auto",mr:"auto"})):Object(r.createElement)("div",{key:e,className:"bwf-funnel-step-analytics__item"},function(e){return o&&(l[e]=Math.floor(901*Math.random())+100),fe[e].isCurrency?s(l[e]||0):l[e]||0}(e),Object(r.createElement)("br",null),Object(r.createElement)("span",{className:"bwf-text-light bwf-text-bold"},"landing"===i&&"conversions"===e?Object(u.__)("Clicks","funnel-builder"):fe[e].label))};return Object(r.createElement)("div",{className:"bwf-funnel-step-analytics"},function(){if(o)return Object(r.createElement)("div",{className:"bwf-funnel-step-analytics__overlay"},Object(r.createElement)("a",{href:Object(b.U)(["Funnel","Steps","Cards","Analytics"]),target:"_blank",rel:"noreferrer"},Object(r.createElement)(ne.c,{content:m,type:"warning",border:!0})))}(),n.map((function(e){return p(e)})))},me=n(63);function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(){return(Oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){ye(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=pe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ge(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _e=window.wffn.is_ab_experiment,he=window.wffn.is_ab_experiment_support,Ee={status:!0,title:Object(u.__)("A/B Testing","funnel-builder"),content:{benefits:[Object(u.__)("Increased Conversion Rates","funnel-builder"),Object(u.__)("Greater Return on Ad Spend","funnel-builder"),Object(u.__)("Reduced Bounce Rates","funnel-builder")]},image:Object(b.T)()+"AB-testing.png",proLink:Object(b.U)(["Order","Bump","AB_Test","Upgrade","Modal"])},Se={type:2,status:!0,proLink:Object(b.U)(["Order","Bump","Duplicate","Upgrade","Modal"]),feature:Object(u.__)("Duplicate Step","funnel-builder")},ke=function(e){var t,n,c,i=e.bump,f=i._data,p=void 0===f?{}:f,v=i.tags,y=i.experiment_status,w=(i.type,i.stats),g=e.bump,h=e.checkoutStep,E=e.checkoutPos,S=e.stepPos,k=e.view,N=e.total,C=e.onSortStart,P=p.title,A=p.status,x=Object(b.G)(),T=j.a.getFunnel(),I=g.id,F=void 0===I?"":I,B=Object(ie.a)().setModalData,L=we(Object(r.useState)(!1),2),z=L[0],U=L[1],M=we(Object(r.useState)({}),2),R=M[0],q=M[1],J=we(Object(r.useState)(!1),2),Q=J[0],Y=J[1],W=we(Object(r.useState)(!1),2),K=W[0],be=W[1],fe=we(Object(r.useState)(!1),2),pe=fe[0],je=fe[1],ye=we(Object(r.useState)(!1),2),ge=ye[0],ke=ye[1],Ne=we(Object(r.useState)(!1),2),Ce=Ne[0],Pe=Ne[1],Ae=we(Object(r.useState)({}),2),xe=Ae[0],Te=Ae[1],Ie=Object(O.a)(),De=Ie.startDuplicateStep,Fe=Ie.startDeleteStep,Be=Ie.setStepTitle,Le=Ie.setUpdateFunnel,ze=Object(oe.a)(),Ue=ze.setToggleState,Me=ze.setSubStep,Re=location&&location.search?Object(l.parse)(location.search.substring(1)):{},qe=Object(D.c)().showSnackbar,Ge=Object(se.a)().setExperimentStatus,Je=Object(ue.a)().setStepHeaderData,$e=function(){if(g.hasOwnProperty("id")&&g.id){Be(Object(V.decodeEntities)(P)+Object(u.__)(" A/B Test","funnel-builder"));var e="/funnels/".concat(x,"/experiments/").concat(g.id);Object(b.kb)()&&(e="/store-checkout/experiments/".concat(g.id)),Object(_.k)({},e)}},He=function(e){Pe(!0);var t="/funnel-bump/save-state/".concat(g.id,"?funnel_id=").concat(x);o()({path:Object(b.y)(t),method:"POST",data:{status:!Number(A)}}).then((function(t){t.success?(Ue(!Number(A)),Pe(!1),ke(!1),je(!1),function(e,t){var n=Object(a.cloneDeep)(null==T?void 0:T.steps).map((function(n){return parseInt(n.id)===parseInt(h.id)&&(n.substeps.wc_order_bump=n.substeps.wc_order_bump.map((function(n){return parseInt(n.id)===parseInt(F)&&(n._data.status=0===parseInt(e)?"1":"0",n.experiment_status=t?"3":n.experiment_status),n}))),n}));T.steps=n;var r=JSON.parse(JSON.stringify(T));Le(r)}(Number(A),e),Te({}),qe(Object(u.__)("Changes Saved","funnel-builder"))):(Ue(Number(A)),Pe(!1),ke(!1),je(!1))})).catch((function(e){console.log(e),Ue(Number(A)),qe(Object(u.__)("Status Updation Failed","funnel-builder"))}))},Qe={1:Object(u.__)("A/B Test Draft","funnel-builder"),2:Object(u.__)("A/B Test Running","funnel-builder"),3:Object(u.__)("A/B Test Paused","funnel-builder")},Ye={1:"warning",2:"success",3:"default"},We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?Ye[e]:Qe[e]},Ke=function(e){if(be(!0),(e=e.trim())===P)Y(!1),be(!1);else if(P!==e.trim()){Be(e);var t='{"title":"'.concat(e,'","slug":"').concat(k.match(/([^\/]*)\/*$/)[1],'"}');o()({path:Object(b.y)("/funnel-bump/save-state/".concat(g.id,"?funnel_id=").concat(x)),data:JSON.parse(t),method:"POST"}).then((function(e){if(!e.success)throw new Error(e.msg);Y(!1),be(!1),qe(Object(u.__)("Changes Saved","funnel-builder")),function(e,t){var n=T.steps.map((function(n){if(n.id===e){var r=n.substeps.wc_order_bump.map((function(e){if(e.id===g.id){var n=ve(ve({},e._data),{},{title:t});return ve(ve({},e),{},{_data:n})}return e}));return n.substeps.wc_order_bump=r,n}return n}));T.steps=n;var r=JSON.parse(JSON.stringify(T));Le(r)}(e.step_data.checkout_id,e.step_data.title)})).catch((function(e){console.log(e.message?e.message:e),Be(P),qe(Object(u.__)("Title Updation Failed","funnel-builder"))}))}},Ve=Object(D.b)(),Xe=Ve.isExpired,Ze=Ve.isProFeatureLocked,et=Ve.isBasicFeatureLocked,tt=Ve.isBasic;return Object(r.createElement)("div",Oe({className:"bwf-st-c"},H),Object(r.createElement)("div",{className:"bwf-st-c-card-container"},Object(r.createElement)("span",{className:"bwf-move-icons"},Object(r.createElement)("span",{className:0===S?"is-disabled":"",onClick:function(){return C("up",S)},title:Object(u.__)("Click here to move up","funnel-builder")},Object(r.createElement)(m.a,{icon:"angle-down",width:16,height:16})),Object(r.createElement)("span",{className:S===N-1?"is-disabled":"",onClick:function(){return C("down",S)},title:Object(u.__)("Click here to move down","funnel-builder")},Object(r.createElement)(m.a,{icon:"angle-down",width:16,height:16}))),Object(r.createElement)("div",{className:"bwf-st-c-title"},Object(r.createElement)("div",{className:"bwf-flex bwf--g8"},Object(r.createElement)("div",{className:"bwf-st-c__step-type"},Object(u.__)("Order Bump","funnel-builder")),Object(r.createElement)(r.Fragment,null,Xe?Object(r.createElement)(me.a,{toolTipText:Object(u.__)("Because your license is expired your order bump will not appear to the customer","funnel-builder"),size:"280",textAlign:"left"},Object(r.createElement)(ne.c,{content:Object(r.createElement)("div",{className:"bwf-flex bwf--g4"},Object(u.__)("License Expired","funnel-builder"),Object(r.createElement)(m.a,{icon:"info",size:"12",color:$.DANGER_COLOR})),type:"danger"})):Object(r.createElement)(r.Fragment,null,Object(a.size)(v)>0&&Object.keys(v).map((function(e){return Object(r.createElement)("div",{key:e,className:"bwf-st-c-badge-wrap",onClick:function(){"no_product"!==e&&"has_rules"!==e||(Je("bump",F,"",{title:P,view_link:k,status:1===Number(A),experiment_status:y}),Object(_.k)({},v[e].edit,Re))}},Object(r.createElement)("div",{className:"bwf-st-c-badge-small "+v[e].label_class},v[e].label))})),!Object(a.isEmpty)(y)&&"4"!==y&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap",onClick:function(){_e&&!Ze?he?(Ge(y),Me({step:"bump",parentId:h.id}),$e()):U(!0):q(Ee)}},Object(r.createElement)(ne.c,{content:(t=y,c="warning"===(n=We(y,!0))?"#B68F40":"success"===n?"#09B29C":"default"===n?"#353030":void 0,Object(r.createElement)(r.Fragment,null,Object(r.createElement)(re.a,{fill:c}),Object(r.createElement)("span",{className:"".concat(void 0!==c?"bwf-mr-4":"")},We(t)))),type:We(y,!0)})),!(A&&1===parseInt(A))&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap"},Object(r.createElement)(ne.c,{content:Object(u.__)("Draft","funnel-builder"),type:"warning",className:"bwf-cursor-default"}))))),Object(r.createElement)("a",{href:Object(b.ab)(x,"order_bump",h.id,g.id),onClick:function(e){e.preventDefault(),Je("bump",F,"",{title:P,view_link:k,status:1===Number(A),experiment_status:y}),Object(_.k)({page:"bwf",path:Object(b.ab)(x,"order_bump",h.id,g.id,!1)},"/",{})}},Object(V.decodeEntities)(P))),tt?Object(r.createElement)("div",null):Object(r.createElement)(de,{type:"bump",stats:w}),Object(r.createElement)("div",{className:"bwf-card-controls"},Object(r.createElement)("a",{href:k,className:"bwf-list-btn is-preview",target:"_blank",rel:"noreferrer"},Object(r.createElement)(m.a,{icon:"view",width:"16",height:"16"}),Object(r.createElement)("span",null,Object(u.__)("Preview","funnel-builder"))),Object(r.createElement)("div",{className:"bwf-card-action  is-ellipsis-menu"},Object(r.createElement)(Z.a,{className:"bwf-c-ellipsis",renderContent:function(e){var t=e.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),Y(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Edit","funnel-builder")))),!(A&&1===parseInt(A))&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),function(){try{Te({status:!0,loading:!0,content:Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf-publish-title bwf-mt-12"},Object(u.__)("Please wait! Publishing ".concat(Object(V.decodeEntities)(P)),"funnel-builder")))}),He()}catch(e){console.log(Object(u.__)("Failed Experiment Creation: ","funnel-builder"),e)}}()}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Publish","funnel-builder")))),["1",1].includes(A)&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),["2",2].includes(y)?je(!0):ke(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Draft","funnel-builder")))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){et?q(Se):(t(),De(ve(ve({},g),{},{type:"wc_order_bump"}),0,h))}},Object(r.createElement)(X.a,{justify:"space-between"},Object(r.createElement)(X.c,null,Object(u.__)("Duplicate","funnel-builder")),et&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){!Ze&&_e?he?(Ge(y),Me({step:"bump",parentId:h.id}),$e()):U(!0):q(Ee)}},Object(r.createElement)(X.a,{justify:"space-between"},Object(r.createElement)(X.c,null,Object(u.__)("A/B Test","funnel-builder")),Ze&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),B({title:P}),Fe(ve(ve({},g),{},{type:"wc_order_bump"}),S,ve(ve({},h),{},{stepPos:E}))},className:"bwf-ellipsis-menu__item-delete"},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Delete","funnel-builder")))))}})))),z&&Object(r.createElement)(s.Modal,{className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-admin-modal-no-header",isDismissible:!1,onRequestClose:function(){return U(!1)}},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf-h1 bwf_align_center"},Object(u.__)("Oops it seems old version of Experiments is activated.","funnel-builder")),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-p"},Object(u.__)("Please deactivate, You won't loose existing experiments for the funnel.","funnel-builder"))),Object(r.createElement)("div",{className:"bwf_clear_30"})),R.status&&Object(r.createElement)(G.a,{isOpen:R.status,onRequestClose:function(){return q({status:!1})},modalContent:R,type:R.type}),Q&&Object(r.createElement)(te.a,{renameTitle:"Edit Details",title:Object(V.decodeEntities)(P),onclose:function(){return Y(!1)},updateTitle:function(e){return Ke(e)},isLoading:K}),ge&&Object(r.createElement)(ae.a,{isPublishLoading:Ce,onAction:function(){return He()},onclose:function(){return ke(!1)}}),pe&&Object(r.createElement)(ce.a,{isPublishLoading:Ce,onAction:function(){He(!0)},onclose:function(){return je(!1)}}),Object(r.createElement)(le.a,{className:d()("bwf-admin-modal-squeezy",xe.className),confirmText:xe.confirmText,confirmButtonText:xe.buttonConfirm,cancelButtonText:xe.buttonCancel,onConfirm:xe.onConfirm,isLoading:xe.loading,successMessage:xe.success,errorMessage:xe.error,content:xe.content,onRequestClose:function(){return Te({status:!1})},modalTitle:xe.modalTitle,isOpen:xe.status,closeIcon:xe.closeIcon}))},Ne=n(415),Ce=n(367);function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(){return(Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Pe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Fe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Be=window.wffn.is_ab_experiment,Le=window.wffn.is_ab_experiment_support,ze={status:!0,title:Object(u.__)("A/B Testing","funnel-builder"),content:{benefits:[Object(u.__)("A/B test product price, page layout, messaging, design & more. Create variants, analyze results & uncover hidden revenue.","funnel-builder")]},image:Object(b.T)()+"AB-testing.png",proLink:Object(b.U)(["Checkout","AB_Test","Upgrade","Modal"])},Ue={type:2,status:!0,proLink:Object(b.U)(["Checkout","Duplicate","Upgrade","Modal"]),feature:Object(u.__)("Duplicate Step","funnel-builder")},Me={bump:!0},Re=function(e){var t=e.step,n=void 0===t?{}:t,c=n._data,i=void 0===c?{}:c,f=n.tags,p=void 0===f?[]:f,v=(n.experiment,n.substeps),y=(void 0===v?{}:v).wc_order_bump,w=void 0===y?[]:y,g=n.id,h=void 0===g?0:g,E=n.experiment_status,S=n.type,k=n.stats,N=e.step,C=e.stepPos,P=void 0===C?0:C,A=(e.title,e.isOBFake),x=e.dragHandleController,T=Object(D.b)(),I=T.isProFeatureLocked,F=T.isBasicFeatureLocked,B=T.isLite,L=T.isBasic,z=Object(D.c)().showSnackbar,U=j.a.getFunnel(),M=Object(ue.a)().setStepHeaderData,R=Object(b.G)(),q=De(Object(r.useState)({}),2),J=q[0],Q=q[1],Y=i.title,W=i.view,te=i.status,be=void 0===te?0:te,fe=Object(ie.a)().setModalData,me=Object(O.a)(),pe=me.startDuplicateStep,Oe=me.startDeleteStep,je=me.startAddStep,ve=me.setShowProModal,ye=me.setShowProModalText,we=me.setStepTitle,ge=(me.fetch,me.sortSubSteps),_e=me.setUpdateFunnel,he=Object(oe.a)(),Ee=he.setToggleState,Se=(he.setStepData,Object(se.a)().setExperimentStatus),Pe=location&&location.search?Object(l.parse)(location.search.substring(1)):{},xe=De(Object(r.useState)(p),2),Ie=xe[0],Fe=xe[1],Re=De(Object(r.useState)(!1),2),qe=Re[0],Ge=Re[1],Je=De(Object(r.useState)(!1),2),$e=Je[0],He=Je[1],Qe=De(Object(r.useState)(!1),2),Ye=Qe[0],We=Qe[1],Ke=De(Object(r.useState)(!1),2),Ve=Ke[0],Xe=Ke[1],Ze=De(Object(r.useState)(!1),2),et=Ze[0],tt=Ze[1],nt=De(Object(r.useState)(!1),2),rt=nt[0],ct=nt[1],at=De(Object(r.useState)({}),2),lt=at[0],it=at[1];Object(r.useEffect)((function(){B||0!==Object(a.size)(w)||"no_bump"in p||Fe(Te(Te({},Ie),{},{no_bump:{label:Object(u.__)("No Order Bump","funnel-builder"),label_class:"bwf-st-c-badge-red"}}))}),[w.length]);var ot,st,ut,bt=Object(b.fb)("wc_order_bump"),ft={1:Object(u.__)("A/B Test Draft","funnel-builder"),2:Object(u.__)("A/B Test Running","funnel-builder"),3:Object(u.__)("A/B Test Paused","funnel-builder")},dt={1:"warning",2:"success",3:"default"},mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?dt[e]:ft[e]},pt=function(e){null!==bt&&je(Te(Te({},bt),{},{parent_id:parseInt(h),is_substep:!0,title:"Order Bump"})),!bt&&ve(!0),!bt&&ye(Object(u.__)("Order Bump is a part of Funnel Builder Pro","funnel-builder")),e.preventDefault()},Ot=function(){if(h){we(Object(V.decodeEntities)(Y)+Object(u.__)(" A/B Test","funnel-builder"));var e="/funnels/".concat(R,"/experiments/").concat(h);Object(b.kb)()&&(e="/store-checkout/experiments/".concat(h)),Object(_.k)({},e)}},jt=function(e){ct(!0);var t="/funnel-".concat(S,"/save-state/").concat(h,"?funnel_id=").concat(R);o()({path:Object(b.y)(t),method:"POST",data:{status:!Number(be)}}).then((function(t){t.success?(Ee(!Number(be)),ct(!1),tt(!1),Xe(!1),function(e,t){var n=null==U?void 0:U.steps.map((function(n){if(n.id===h){var r=Te(Te({},n._data),{},{status:e?"1":"0"});return Te(Te({},n),{},{_data:r,experiment_status:t?"3":n.experiment_status})}return n}));U.steps=n;var r=JSON.parse(JSON.stringify(U));_e(r)}(Number(t.step_data.status),e),it({}),z(Object(u.__)("Changes Saved","funnel-builder"))):(Ee(Number(be)),ct(!1),tt(!1),Xe(!1))})).catch((function(e){console.log(e),Ee(Number(be)),z("Status Updation Failed")}))},vt=function(e,t){var n=[];"up"===e?n=ge(h,"wc_order_bump",t,t-1):"down"===e&&(n=ge(h,"wc_order_bump",t,t+1)),o()({path:Object(b.y)("/funnels/steps/order/save/".concat(h,"?type=wc_order_bump")),method:"POST",data:{order:n.map((function(e){return e.id}))}}).then((function(e){e.success||console.log(e)})).catch((function(e){console.log(e)}))},yt=function(e,t){if(We(!0),(e=e.trim())===Y&&(null==i?void 0:i.post_name)===t)He(!1),We(!1);else{we(e);var n='{"title":"'.concat(e,'","slug":"').concat(t,'"}');o()({path:Object(b.y)("/funnel-".concat(S,"/save-state/").concat(h,"?funnel_id=").concat(R)),data:JSON.parse(n),method:"POST"}).then((function(e){if(!e.success)throw new Error(e.msg);He(!1),We(!1),function(e,t,n){var r=U.steps.map((function(r){return r.id===Number(h)?(r._data.title=e,r._data.post_name=t,r._data.view_link=n,r):r}));U.steps=r;var c=JSON.parse(JSON.stringify(U));_e(c)}(e.step_data.title,t,e.step_data.view_link),z(Object(u.__)("Changes Saved","funnel-builder"))})).catch((function(e){console.log(e.message?e.message:e),we(Y),z(Object(u.__)("Title Updation Failed","funnel-builder"))}))}};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-card-container"},x(),Object(r.createElement)("div",{className:"bwf-st-c-title"},Object(r.createElement)("div",{className:"bwf-flex bwf--g8"},Object(r.createElement)("div",{className:"bwf-st-c__step-type"},Object(b.sb)(S)),Object(r.createElement)(r.Fragment,null,Object(a.size)(p)>0&&Object.keys(Ie).map((function(e){return("no_bump"!==e||!B&&0===Object(a.size)(w))&&"global_checkout"!==e&&Object(r.createElement)("div",{key:e,className:"bwf-st-c-badge-wrap",onClick:function(t){"no_product"===e?(M("checkout",h,"",{title:Y,view_link:W,status:1===Number(be),experiment_status:E}),Object(_.k)({},Ie[e].edit,Pe)):"no_bump"===e&&(I?Q(Me):pt(t))}},Object(r.createElement)("div",{className:"bwf-st-c-badge-small "+Ie[e].label_class},Ie[e].label))})),!Object(a.isEmpty)(E)&&"4"!==E&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap",onClick:function(){Be&&!I?Le?(Se(E),Ot()):Ge(!0):Q(ze)}},Object(r.createElement)(ne.c,{content:(ot=E,ut="warning"===(st=mt(E,!0))?"#B68F40":"success"===st?"#09B29C":"default"===st?"#353030":void 0,Object(r.createElement)(r.Fragment,null,Object(r.createElement)(re.a,{fill:ut}),Object(r.createElement)("span",{className:"".concat(void 0!==ut?"bwf-mr-4":"")},mt(ot)))),type:mt(E,!0)})),!(be&&1===parseInt(be))&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap"},Object(r.createElement)(ne.c,{content:Object(u.__)("Draft","funnel-builder"),className:"bwf-cursor-default",type:"warning"})))),Object(r.createElement)("a",{href:Object(b.ab)(R,"wc_checkout",N.id),onClick:function(e){e.preventDefault(),M("checkout",h,"",{title:Y,view_link:W,status:1===Number(be),experiment_status:E}),Object(_.k)({page:"bwf",path:Object(b.ab)(R,"wc_checkout",N.id,"",!1)},"/",{})}},Object(V.decodeEntities)(Y)," ")),L?Object(r.createElement)("div",null):Object(r.createElement)(de,{type:S,stats:k}),Object(r.createElement)("div",{className:"bwf-card-controls"},Object(r.createElement)("a",{href:Object(V.decodeEntities)(W),className:"bwf-list-btn is-preview",target:"_blank",rel:"noreferrer"},Object(r.createElement)(m.a,{icon:"view",width:"16",height:"16"}),Object(r.createElement)("span",null,Object(u.__)("Preview","funnel-builder"))),Object(r.createElement)("div",{className:"bwf-card-action  is-ellipsis-menu"},Object(r.createElement)(Z.a,{className:"bwf-c-ellipsis",renderContent:function(e){var t=e.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),He(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Edit","funnel-builder")))),!(be&&1===parseInt(be))&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),function(){try{it({status:!0,loading:!0,content:Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf-publish-title bwf-mt-12"},Object(u.__)("Please wait! Publishing ".concat(Object(V.decodeEntities)(Y)),"funnel-builder")))}),jt()}catch(e){console.log(Object(u.__)("Failed Experiment Creation: ","funnel-builder"),e)}}()}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Publish","funnel-builder")))),["1",1].includes(be)&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),["2",2].includes(E)?Xe(!0):tt(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Draft","funnel-builder")))),!Object(b.kb)()&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){F?Q(Ue):(t(),pe(N,P+1))}},Object(r.createElement)(X.a,{justify:"space-between"},Object(r.createElement)(X.c,null,Object(u.__)("Duplicate","funnel-builder")),F&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){!I&&Be?Le?(Se(E),Ot()):Ge(!0):Q(ze)}},Object(r.createElement)(X.a,{justify:"space-between"},Object(r.createElement)(X.c,null,Object(u.__)("A/B Test","funnel-builder")),I&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),fe({title:Y}),Oe(N,P)},className:"bwf-ellipsis-menu__item-delete"},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Delete","funnel-builder")))))}})))),J.status&&Object(r.createElement)(G.a,{isOpen:J.status,onRequestClose:function(){return Q({status:!1})},modalContent:J,type:J.type}),qe&&Object(r.createElement)(s.Modal,{className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-admin-modal-no-header",isDismissible:!1,onRequestClose:function(){return Ge(!1)}},Object(r.createElement)("div",{className:"bwf-modal-custom-header bwf-flex bwf--space-between"},Object(r.createElement)("div",{className:"bwf-modal-title"},Object(u.__)("Oops it seems old version of Experiments is activated.","funnel-builder"))),Object(r.createElement)("div",{className:"bwf-modal-content"},Object(u.__)("Please deactivate, You won't loose existing experiments for the funnel.","funnel-builder")),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"".concat(isRtl?" wf_funnel_left_align":" wf_funnel_right_align")},Object(r.createElement)(s.Button,{variant:"primary",onClick:function(){return Ge(!1)}},Object(u.__)("OK","funnel-builder")))),null!==bt&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-sub-st-wrap"},Object(a.size)(w)>0&&w.map((function(e,t){return Object(r.createElement)(ke,{key:t,bump:e,checkoutStep:N,checkoutPos:P,stepPos:t,total:Object(a.size)(w),view:Object(V.decodeEntities)(W),onSortStart:vt})})),Object(r.createElement)("div",Ae({className:"bwf-st-c-sub-st-action-wrap"},H),Object(r.createElement)(s.Button,{isSecondary:!0,onClick:function(e){I?Q(Me):pt(e)}},I&&Object(r.createElement)(m.a,{icon:"king",color:$.NOTICE_YELLOW,size:20}),Object(u.__)("Add Order Bump","funnel-builder"))))),A&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-sub-st-wrap is-ob-fake"},Object(r.createElement)(K,{type:"order_bump",onClick:function(){return ve(!0)},modalContent:{title:Object(u.__)("Order Bump","funnel-builder"),content:{benefits:[Object(u.__)("Boost your sales effortlessly with the Order Bumps. Let users add products with just one click on checkout page.","funnel-builder")]},image:Object(b.T)()+"order-bump.png",proLink:Object(b.U)(["Order","Bump","Upgrade","Modal"])}}))),$e&&Object(r.createElement)(Ne.a,{pageUrl:null==i?void 0:i.view_link,pageUrlSlug:null==i?void 0:i.post_name,renameTitle:"Step",title:Object(V.decodeEntities)(Y),onclose:function(){return He(!1)},updateDetail:function(e,t){return yt(e,t)},isLoading:Ye}),et&&Object(r.createElement)(ae.a,{isPublishLoading:rt,onAction:function(){return jt()},onclose:function(){return tt(!1)}}),Ve&&Object(r.createElement)(ce.a,{isPublishLoading:rt,onAction:function(){jt(!0)},onclose:function(){return Xe(!1)}}),J.bump&&Object(r.createElement)(Ce.a,{isOpen:J.bump,onRequestClose:function(){return Q({status:!1})}}),Object(r.createElement)(le.a,{className:d()("bwf-admin-modal-squeezy",lt.className),confirmText:lt.confirmText,confirmButtonText:lt.buttonConfirm,cancelButtonText:lt.buttonCancel,onConfirm:lt.onConfirm,isLoading:lt.loading,successMessage:lt.success,errorMessage:lt.error,content:lt.content,onRequestClose:function(){return it({status:!1})},modalTitle:lt.modalTitle,isOpen:lt.status,closeIcon:lt.closeIcon}))};function qe(e){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(){return(Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){He(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function He(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=qe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=qe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ye(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ye(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var We=window.wffn.is_ab_experiment,Ke=window.wffn.is_ab_experiment_support,Ve={status:!0,title:Object(u.__)("A/B Testing","funnel-builder"),content:{benefits:[Object(u.__)("Increased Conversion Rates","funnel-builder"),Object(u.__)("Greater Return on Ad Spend","funnel-builder"),Object(u.__)("Reduced Bounce Rates","funnel-builder")]},image:Object(b.T)()+"AB-testing.png",proLink:Object(b.U)(["Offer","AB_Test","Upgrade","Modal"])},Xe={type:2,status:!0,proLink:Object(b.U)(["Offer","Duplicate","Upgrade","Modal"]),feature:Object(u.__)("Duplicate Step","funnel-builder")},Ze=function(e){var t,n,c,i=e.offer,f=i._data,p=void 0===f?{}:f,v=i.tags,y=(i.experiment,i.experiment_status),w=i.stats,g=e.offer,h=e.upsellStep,E=e.upsellPos,S=e.stepPos,k=e.view,N=e.total,C=e.onSortStart,P=p.title,A=p.status,x=g.id,T=void 0===x?"":x,I=Object(b.G)(),F=j.a.getFunnel(),B=Object(ie.a)().setModalData,L=Qe(Object(r.useState)(!1),2),z=L[0],U=L[1],M=Qe(Object(r.useState)({}),2),R=M[0],q=M[1],J=Qe(Object(r.useState)(!1),2),Q=J[0],Y=J[1],W=Qe(Object(r.useState)(!1),2),K=W[0],te=W[1],be=Qe(Object(r.useState)(!1),2),fe=be[0],pe=be[1],Oe=Qe(Object(r.useState)(!1),2),je=Oe[0],ve=Oe[1],ye=Qe(Object(r.useState)(!1),2),we=ye[0],ge=ye[1],_e=Qe(Object(r.useState)({}),2),he=_e[0],Ee=_e[1],Se=Object(D.b)("ul").isExpired,ke=Object(D.b)(),Ce=ke.isProFeatureLocked,Pe=ke.isBasicFeatureLocked,Ae=ke.isBasic,xe=Object(O.a)(),Te=xe.startDuplicateStep,Ie=xe.startDeleteStep,De=xe.setStepTitle,Fe=xe.setUpdateFunnel,Be=Object(oe.a)(),Le=Be.setToggleState,ze=Be.setSubStep,Ue=Object(se.a)().setExperimentStatus,Me=Object(ue.a)().setStepHeaderData,Re=location&&location.search?Object(l.parse)(location.search.substring(1)):{},qe=Object(D.c)().showSnackbar,Je=function(){if(g.hasOwnProperty("id")&&g.id){De(Object(V.decodeEntities)(P)+Object(u.__)(" A/B Test"));var e="/funnels/".concat(I,"/experiments/").concat(g.id);Object(b.kb)()&&(e="/store-checkout/experiments/".concat(g.id)),Object(_.k)({},e)}},He={1:Object(u.__)("A/B Test Draft"),2:Object(u.__)("A/B Test Running"),3:Object(u.__)("A/B Test Paused")},Ye={1:"warning",2:"success",3:"default"},Ze=function(e){ge(!0);var t="/funnel-".concat("offer","/save-state/",g.id,"?funnel_id=").concat(I);o()({path:Object(b.y)(t),method:"POST",data:{status:!Number(A)}}).then((function(t){t.success?(Le(!Number(A)),ge(!1),ve(!1),pe(!1),function(e,t){var n=Object(a.cloneDeep)(null==F?void 0:F.steps).map((function(n){return parseInt(n.id)===parseInt(h.id)&&(n.substeps.offer=n.substeps.offer.map((function(n){return parseInt(n.id)===parseInt(T)&&(n._data.status=0===parseInt(e)?"1":"0",n.experiment_status=t?"3":n.experiment_status),n}))),n}));F.steps=n;var r=JSON.parse(JSON.stringify(F));Fe(r)}(Number(A),e),Ee({}),qe(Object(u.__)("Changes Saved","funnel-builder"))):(Le(Number(A)),ge(!1),ve(!1),pe(!1))})).catch((function(e){console.log(e),Le(Number(A)),qe("Status Updation Failed")}))},et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?Ye[e]:He[e]},tt=function(e,t){if(te(!0),(e=e.trim())===P&&(null==p?void 0:p.post_name)===t)Y(!1),te(!1);else{De(e);var n='{"title":"'.concat(e,'","slug":"').concat(t,'"}');o()({path:Object(b.y)("/funnel-".concat("offer","/save-state/",g.id,"?funnel_id=").concat(I)),data:JSON.parse(n),method:"POST"}).then((function(e){if(!e.success)throw new Error(e.msg);Y(!1),te(!1),function(e,t,n,r){var c=F.steps.map((function(c){if(c.id===Number(e)){var a=c.substeps.offer.map((function(e){if(e.id===g.id){var c=$e($e({},e._data),{},{title:t,post_name:n,view_link:r});return $e($e({},e),{},{_data:c})}return e}));return c.substeps.offer=a,c}return c}));F.steps=c;var a=JSON.parse(JSON.stringify(F));Fe(a)}(e.step_data.upsell_id,e.step_data.title,t,e.step_data.view_link),qe(Object(u.__)("Changes Saved","funnel-builder"))})).catch((function(e){console.log(e.message?e.message:e),De(P),qe("Title Updation Failed")}))}};return Object(r.createElement)("div",Ge({className:"bwf-st-c"},H),Object(r.createElement)("div",{className:"bwf-st-c-card-container"},Object(r.createElement)("span",{className:"bwf-move-icons"},Object(r.createElement)("span",{className:0===S?"is-disabled":"",onClick:function(){return C("up",S)},title:"Click here to move up"},Object(r.createElement)(m.a,{icon:"angle-down",width:16,height:16})),Object(r.createElement)("span",{className:S===N-1?"is-disabled":"",onClick:function(){return C("down",S)},title:"Click here to move down"},Object(r.createElement)(m.a,{icon:"angle-down",width:16,height:16}))),Object(r.createElement)("div",{className:"bwf-st-c-title"},Object(r.createElement)("div",{className:"bwf-flex bwf--g8"},Object(r.createElement)("div",{className:"bwf-st-c__step-type"},Object(b.sb)("offer")),Object(r.createElement)(r.Fragment,null,Se?Object(r.createElement)(me.a,{toolTipText:Object(u.__)("Because your license is expired your upsell offers will not appear to the customer","funnel-builder"),size:"280",textAlign:"left"},Object(r.createElement)(ne.c,{content:Object(r.createElement)("div",{className:"bwf-flex bwf--g4"},Object(u.__)("License Expired","funnel-builder"),Object(r.createElement)(m.a,{icon:"info",size:"12",color:$.DANGER_COLOR})),type:"danger"})):Object(r.createElement)(r.Fragment,null,Object(a.size)(v)>0&&Object.keys(v).map((function(e){return Object(r.createElement)("div",{key:e,className:"bwf-st-c-badge-wrap",onClick:function(){"no_product"===e&&(Me("offer",T,T,{title:P,view_link:k,status:1===Number(A),experiment_status:y}),Object(_.k)({},v[e].edit,Re))}},Object(r.createElement)("div",{className:"bwf-st-c-badge-small "+v[e].label_class},v[e].label))})),!Object(a.isEmpty)(y)&&"4"!==y&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap",onClick:function(){We&&!Ce?Ke?(ze({step:"offer",parentId:h.id}),Ue(y),Je()):U(!0):q(Ve)}},Object(r.createElement)(ne.c,{content:(t=y,c="warning"===(n=et(y,!0))?"#B68F40":"success"===n?"#09B29C":"default"===n?"#353030":void 0,Object(r.createElement)(r.Fragment,null,Object(r.createElement)(re.a,{fill:c}),Object(r.createElement)("span",{className:"".concat(void 0!==c?"bwf-mr-4":"")},et(t)))),type:et(y,!0)})),!(A&&1===parseInt(A))&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap"},Object(r.createElement)(ne.c,{content:Object(u.__)("Draft","funnel-builder"),type:"warning",className:"bwf-cursor-default"}))))),Object(r.createElement)("a",{href:Object(b.ab)(I,"offer",h.id,g.id),onClick:function(e){e.preventDefault(),Me("offer",T,T,{title:P,view_link:k,status:1===Number(A),experiment_status:y}),Object(_.k)({page:"bwf",path:Object(b.ab)(I,"offer",h.id,g.id,!1)},"/",{})}},Object(V.decodeEntities)(P))),Ae?Object(r.createElement)("div",null):Object(r.createElement)(de,{type:"offer",stats:w}),Object(r.createElement)("div",{className:"bwf-card-controls"},Object(r.createElement)("a",{href:null==p?void 0:p.view,className:"bwf-list-btn is-preview",target:"_blank",rel:"noreferrer"},Object(r.createElement)(m.a,{icon:"view",width:"16",height:"16"}),Object(r.createElement)("span",null,Object(u.__)("Preview","funnel-builder"))),Object(r.createElement)("div",{className:"bwf-card-action  is-ellipsis-menu"},Object(r.createElement)(Z.a,{className:"bwf-c-ellipsis",renderContent:function(e){var t=e.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),Y(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Edit","funnel-builder")))),!(A&&1===parseInt(A))&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),function(){try{Ee({status:!0,loading:!0,content:Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf-publish-title bwf-mt-12"},Object(u.__)("Please wait! Publishing ".concat(Object(V.decodeEntities)(P)),"funnel-builder")))}),Ze()}catch(e){console.log(Object(u.__)("Failed Experiment Creation: ","funnel-builder"),e)}}()}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Publish","funnel-builder")))),["1",1].includes(A)&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),["2",2].includes(y)?pe(!0):ve(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Draft","funnel-builder")))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){Pe?q(Xe):(t(),Te($e($e({},g),{},{type:"offer"}),0,h))}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Duplicate","funnel-builder")),Pe&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){!Ce&&We?(Ue(y),Ke?(ze({step:"offer",parentId:h.id}),Je()):U(!0)):q(Ve)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("A/B Test","funnel-builder")),Ce&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),B({title:P}),Ie($e($e({},g),{},{type:"offer"}),S,$e($e({},h),{},{stepPos:E}))},className:"bwf-ellipsis-menu__item-delete"},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Delete","funnel-builder")))))}})))),z&&Object(r.createElement)(s.Modal,{className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-admin-modal-no-header",isDismissible:!1,onRequestClose:function(){return U(!1)}},Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf-h1 bwf_align_center"},Object(u.__)("Oops it seems old version of Experiments is activated.")),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-p"},Object(u.__)("Please deactivate, You won't loose existing experiments for the funnel."))),Object(r.createElement)("div",{className:"bwf_clear_30"})),R.status&&Object(r.createElement)(G.a,{isOpen:R.status,onRequestClose:function(){return q({status:!1})},modalContent:R,type:R.type}),Q&&Object(r.createElement)(Ne.a,{pageUrl:null==p?void 0:p.view_link,pageUrlSlug:null==p?void 0:p.post_name,renameTitle:"Step",title:Object(V.decodeEntities)(P),onclose:function(){return Y(!1)},updateDetail:function(e,t){return tt(e,t)},isLoading:K}),je&&Object(r.createElement)(ae.a,{isPublishLoading:we,onAction:function(){return Ze()},onclose:function(){return ve(!1)}}),fe&&Object(r.createElement)(ce.a,{isPublishLoading:we,onAction:function(){Ze(!0)},onclose:function(){return pe(!1)}}),Object(r.createElement)(le.a,{className:d()("bwf-admin-modal-squeezy",he.className),confirmText:he.confirmText,confirmButtonText:he.buttonConfirm,cancelButtonText:he.buttonCancel,onConfirm:he.onConfirm,isLoading:he.loading,successMessage:he.success,errorMessage:he.error,content:he.content,onRequestClose:function(){return Ee({status:!1})},modalTitle:he.modalTitle,isOpen:he.status,closeIcon:he.closeIcon}))};function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(){return(tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=et(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==et(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function at(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return lt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var it=window.wffn.is_ab_experiment,ot=window.wffn.is_ab_experiment_support,st=function(e){return{status:!0,title:Object(u.__)("A/B Testing","funnel-builder"),content:{benefits:[Object(u.__)("Increased Conversion Rates","funnel-builder"),Object(u.__)("Greater Return on Ad Spend","funnel-builder"),Object(u.__)("Reduced Bounce Rates","funnel-builder")]},image:Object(b.T)()+"AB-testing.png",proLink:Object(b.U)([e.replace(" ","+"),"AB_Test","Upgrade","Modal"])}},ut={status:!0,title:Object(u.__)("Add Offer","funnel-builder"),proLink:Object(b.U)(["Add","Offer","Upgrade","Modal"])},bt=function(e){return{type:2,status:!0,proLink:Object(b.U)([e.replace(" ","+"),"Duplicate","Upgrade","Modal"]),feature:Object(u.__)("Duplicate Step","funnel-builder")}},ft=function(e){var t=e.step,n=void 0===t?{}:t,c=n._data,i=void 0===c?{}:c,f=n.tags,p=void 0===f?[]:f,y=n.type,w=n.substeps,g=(void 0===w?{}:w).offer,h=void 0===g?[]:g,E=(n.experiment,n.experiment_status),S=n.stats,k=e.stepPos,N=e.step,C=e.title,P=e.dragHandleController,A=i.title,x=i.view,T=i.status,I=Object(b.G)(),F=j.a.getFunnel(),B=at(Object(r.useState)(!1),2),L=B[0],z=B[1],U=at(Object(r.useState)(p),2),M=U[0],R=U[1],q=at(Object(r.useState)(!1),2),J=q[0],Q=q[1],Y=at(Object(r.useState)(!1),2),W=Y[0],K=Y[1],be=at(Object(r.useState)(!1),2),fe=be[0],pe=be[1],Oe=at(Object(r.useState)(!1),2),je=Oe[0],ve=Oe[1],ye=at(Object(r.useState)(!1),2),we=ye[0],ge=ye[1],_e=at(Object(r.useState)({}),2),he=_e[0],Ee=_e[1],Se=at(Object(r.useState)({}),2),ke=Se[0],Ce=Se[1],Pe=Object(D.b)(),Ae=Pe.isProFeatureLocked,xe=Pe.isBasicFeatureLocked,Te=Pe.isBasic,Ie=Object(D.b)("ul").isExpired,De=Object(O.a)(),Fe=De.startDuplicateStep,Be=De.startDeleteStep,Le=De.setStepTitle,ze=De.sortSubSteps,Ue=De.setUpdateFunnel,Me=Object(oe.a)().setToggleState,Re=Object(ue.a)().setStepHeaderData,qe=Object(ie.a)().setModalData,Ge=Object(v.a)(),Je=Ge.setActiveGroup,$e=Ge.setImportOffer,He=Object(se.a)().setExperimentStatus,Qe=Object(D.c)().showSnackbar,Ye=location&&location.search?Object(l.parse)(location.search.substring(1)):{},We=function(){if(N&&N.hasOwnProperty("id")&&N.id){Le(Object(V.decodeEntities)(A)+Object(u.__)(" A/B Test","funnel-builder"));var e="/funnels/".concat(I,"/experiments/").concat(N.id);Object(b.kb)()&&(e="/store-checkout/experiments/".concat(N.id)),Object(_.k)({},e)}},Ke=function(e){ge(!0);var t="/funnel-".concat(y,"/save-state/").concat(N.id,"?funnel_id=").concat(I);o()({path:Object(b.y)(t),method:"POST",data:{status:!Number(T)}}).then((function(t){t.success?(Me(!Number(T)),ge(!1),ve(!1),pe(!1),function(e,t,n){var r=null==F?void 0:F.steps.map((function(r){if(r.id===N.id){r.experiment_status=n;var c=rt(rt({},r._data),{},{status:e?"1":"0",experiment_status:t?"3":r.experiment_status});return rt(rt({},r),{},{_data:c})}return r}));F.steps=r;var c=JSON.parse(JSON.stringify(F));Ue(c)}(Number(t.step_data.status),e,t.step_data.experiment_status),Ee({}),Qe(Object(u.__)("Changes Saved","funnel-builder"))):(Me(Number(T)),ge(!1),ve(!1),pe(!1))})).catch((function(e){console.log(e),Me(T),Qe("Status Updation Failed")}))},Ve={1:Object(u.__)("A/B Test Draft","funnel-builder"),2:Object(u.__)("A/B Test Running","funnel-builder"),3:Object(u.__)("A/B Test Paused","funnel-builder")},Xe={1:"warning",2:"success",3:"default"},et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?Xe[e]:Ve[e]};Object(r.useEffect)((function(){0!==Object(a.size)(h)||"wc_upsells"!==y||"no_offers"in p?Object(a.size)(h)>0&&R(p):R(rt(rt({},M),{},{no_offers:{offerlabel:Object(u.__)("No offers","funnel-builder"),label_class:"bwf-st-c-badge-red"}}))}),[h.length]);var nt,ct,lt,ft=function(e){e.preventDefault(),Je("upsell"),$e({parent_id:parseInt(N.id),parent_title:N._data.title}),Object(_.k)({importType:"step"})},dt=function(e,t){if(K(!0),(e=e.trim())!==A||(null==i?void 0:i.post_name)!==t&&"wc_upsells"!=y){Le(e);var n='{"title":"'.concat(e,'","slug":"').concat("wc_upsells"==y?x.match(/([^\/]*)\/*$/)[1]:t,'"}');o()({path:Object(b.y)("/funnel-".concat(y,"/save-state/").concat(N.id,"?funnel_id=").concat(I)),data:JSON.parse(n),method:"POST"}).then((function(e){if(!e.success)throw new Error(e.msg);Q(!1),K(!1),function(e,t,n){var r=F.steps.map((function(r){return r.id===Number(N.id)?(r._data.title=e,r._data.post_name=t,r._data.view_link=n,r):r}));F.steps=r;var c=JSON.parse(JSON.stringify(F));Ue(c)}(e.step_data.title,t,e.step_data.view_link),Qe(Object(u.__)("Changes Saved","funnel-builder"))})).catch((function(e){console.log(e.message?e.message:e),Le(A),Qe("Title Updation Failed")}))}else Q(!1),K(!1)};return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-card-container"},P(),Object(r.createElement)("div",{className:"bwf-st-c-title"},Object(r.createElement)("div",{className:"bwf-flex bwf--g8"},Object(r.createElement)("div",{className:"bwf-st-c__step-type"},"wc_upsells"===y?Object(u.__)("One Click Upsell","funnel-builder"):Object(b.sb)(y)),Object(r.createElement)(r.Fragment,null,"wc_upsells"===y&&Ie&&0===Object(a.size)(h)?Object(r.createElement)(me.a,{toolTipText:Object(u.__)("Because your license is expired your upsell offers will not appear to the customer","funnel-builder"),size:"280",textAlign:"left"},Object(r.createElement)(ne.c,{content:Object(r.createElement)("div",{className:"bwf-flex bwf--g4"},Object(u.__)("License Expired","funnel-builder"),Object(r.createElement)(m.a,{icon:"info",size:"12",color:$.DANGER_COLOR})),type:"danger"})):Object(r.createElement)(r.Fragment,null,Object(a.size)(M)>0&&Object.keys(M).map((function(e){return Object(r.createElement)("div",{key:e,className:"bwf-st-c-badge-wrap",onClick:function(t){"no_product"===e||"has_rules"===e?(Re(Object(b.bb)(y),N.id,"",{title:A,view_link:x,status:1===Number(T),experiment_status:E}),Object(_.k)({},M[e].edit,Ye)):"no_offers"===e&&ft(t)}},Object(r.createElement)("div",{className:d()("bwf-st-c-badge-small",M[e].label_class)},M[e].hasOwnProperty("offerlabel")?M[e].offerlabel:M[e].label))})),!Object(a.isEmpty)(E)&&"4"!==E&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap",onClick:function(){!Ae&&it?ot?(He(E),We()):z(!0):Ce(st)}},Object(r.createElement)(ne.c,{content:(nt=E,lt="warning"===(ct=et(E,!0))?"#B68F40":"success"===ct?"#09B29C":"default"===ct?"#353030":void 0,Object(r.createElement)(r.Fragment,null,Object(r.createElement)(re.a,{fill:lt}),Object(r.createElement)("span",{className:"".concat(void 0!==lt?"bwf-mr-4":"")},et(nt)))),type:et(E,!0)})),!(T&&1===parseInt(T))&&Object(r.createElement)("div",{className:"bwf-st-c-badge-wrap"},Object(r.createElement)(ne.c,{content:Object(u.__)("Draft","funnel-builder"),type:"warning",className:"bwf-cursor-default"}))))),Object(r.createElement)("a",{href:Object(b.ab)(I,y,N.id),className:"bwf-card-action",onClick:function(e){e.preventDefault(),Re(Object(b.bb)(y),N.id,"",{title:A,view_link:x,status:1===Number(T),experiment_status:E}),Object(_.k)({page:"bwf",path:Object(b.ab)(I,y,N.id,"",!1)},"/",{})}},Object(V.decodeEntities)(A))),"wc_upsells"===y||Te?Object(r.createElement)("div",null):Object(r.createElement)(de,{type:y,stats:S}),Object(r.createElement)("div",{className:"bwf-card-controls"},Object(r.createElement)("a",{href:Object(V.decodeEntities)(x),className:"bwf-list-btn is-preview",target:"_blank",rel:"noreferrer"},Object(r.createElement)(m.a,{icon:"view",width:"16",height:"16"}),Object(r.createElement)("span",null,Object(u.__)("Preview","funnel-builder"))),Object(r.createElement)("div",{className:"bwf-card-action is-ellipsis-menu"},Object(r.createElement)(Z.a,{className:"bwf-c-ellipsis",renderContent:function(e){var t=e.onToggle;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),Q(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Edit","funnel-builder")))),!(T&&1===parseInt(T))&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),function(){try{Ee({status:!0,loading:!0,content:Object(r.createElement)("div",{className:"bwf-t-center"},Object(r.createElement)("div",{className:"bwf-publish-title bwf-mt-12"},Object(u.__)("Please wait! Publishing ".concat(Object(V.decodeEntities)(A)),"funnel-builder")))}),Ke()}catch(e){console.log(Object(u.__)("Failed Experiment Creation: ","funnel-builder"),e)}}()}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Publish","funnel-builder")))),["1",1].includes(T)&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),["2",2].includes(E)?pe(!0):ve(!0)}},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Draft","funnel-builder")))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){xe?Ce(bt(C)):(t(),Fe(N,k+1))}},Object(r.createElement)(X.a,{justify:"space-between"},Object(r.createElement)(X.c,null,Object(u.__)("Duplicate","funnel-builder")),xe&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),"wc_upsells"!==y&&Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){!Ae&&it?ot?(We(),He(E)):z(!0):Ce(st(C))}},Object(r.createElement)(X.a,{justify:"space-between"},Object(r.createElement)(X.c,null,Object(u.__)("A/B Test","funnel-builder")),Ae&&Object(r.createElement)(X.c,null,Object(r.createElement)(ne.b,null)))),Object(r.createElement)(ee.a,{isClickable:!0,onInvoke:function(){t(),qe({title:A}),Be(N,k)},className:"bwf-ellipsis-menu__item-delete"},Object(r.createElement)(X.a,{justify:"flex-start"},Object(r.createElement)(X.c,null,Object(u.__)("Delete","funnel-builder")))))}})))),ke.status&&Object(r.createElement)(G.a,{isOpen:ke.status,onRequestClose:function(){return Ce({status:!1})},modalContent:ke,type:ke.type}),L&&Object(r.createElement)(s.Modal,{className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-admin-modal-no-header",isDismissible:!1,onRequestClose:function(){return z(!1)}},Object(r.createElement)("div",{className:"bwf-modal-custom-header bwf-flex bwf--space-between"},Object(r.createElement)("div",{className:"bwf-modal-title"},Object(u.__)("Oops it seems old version of Experiments is activated."))),Object(r.createElement)("div",{className:"bwf-modal-content"},Object(u.__)("Please deactivate, You won't loose existing experiments for the funnel.")),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"".concat(isRtl?" wf_funnel_left_align":" wf_funnel_right_align")},Object(r.createElement)(s.Button,{variant:"primary",onClick:function(){return z(!1)}},Object(u.__)("OK")))),"wc_upsells"==y&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-sub-st-wrap"},Object(a.size)(h)>0&&h.map((function(e,t){return Object(r.createElement)(Ze,{key:t,offer:e,upsellStep:N,upsellPos:k,stepPos:t,total:Object(a.size)(h),view:Object(V.decodeEntities)(x),onSortStart:function(e,t){return function(e,t,n){var r=[];"up"===t?r=ze(e,"offer",n,n-1):"down"===t&&(r=ze(e,"offer",n,n+1)),o()({path:Object(b.y)("/funnels/steps/order/save/".concat(e,"?type=offer")),method:"POST",data:{order:r.map((function(e){return e.id}))}}).then((function(e){e.success||console.log(e)})).catch((function(e){console.log(e)}))}(N.id,e,t)}})})),Object(r.createElement)("div",tt({className:"bwf-st-c-sub-st-action-wrap"},H),Object(r.createElement)(s.Button,{isSecondary:!0,onClick:function(e){Ie?Ce(ut):ft(e)}},Ie&&Object(r.createElement)(m.a,{icon:"king",color:$.NOTICE_YELLOW,size:20}),Object(u.__)("Add Offer","funnel-builder"))))),J&&("wc_upsells"==y?Object(r.createElement)(te.a,{renameTitle:"Edit Details",title:Object(V.decodeEntities)(A),onclose:function(){return Q(!1)},updateTitle:function(e){return dt(e)},isLoading:W}):Object(r.createElement)(Ne.a,{pageUrl:null==i?void 0:i.view_link,pageUrlSlug:null==i?void 0:i.post_name,renameTitle:"Step",title:Object(V.decodeEntities)(A),onclose:function(){return Q(!1)},updateDetail:function(e,t){return dt(e,t)},isLoading:W})),je&&Object(r.createElement)(ae.a,{isPublishLoading:we,onAction:function(){return Ke()},onclose:function(){return ve(!1)}}),fe&&Object(r.createElement)(ce.a,{isPublishLoading:we,onAction:function(){Ke(!0)},onclose:function(){return pe(!1)}}),Object(r.createElement)(le.a,{className:d()("bwf-admin-modal-squeezy",he.className),confirmText:he.confirmText,confirmButtonText:he.buttonConfirm,cancelButtonText:he.buttonCancel,onConfirm:he.onConfirm,isLoading:he.loading,successMessage:he.success,errorMessage:he.error,content:he.content,onRequestClose:function(){return Ee({status:!1})},modalTitle:he.modalTitle,isOpen:he.status,closeIcon:he.closeIcon}))};function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=dt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var yt=function(e){var t=e.step,n=void 0===t?{}:t,l=n._data,i=void 0===l?{}:l,o=n.tags,f=void 0===o?[]:o,d=(n.experiment,n.substeps),p=(void 0===d?{}:d).wc_order_bump,j=void 0===p?[]:p,v=n.id,y=void 0===v?0:v,w=(n.experiment_status,e.step),g=e.stepPos,h=void 0===g?0:g,E=(e.title,e.isOBFake),S=e.dragHandleController,k=Object(D.b)(),N=k.isProFeatureLocked,C=(k.isExpired,k.isLite),P=(Object(c.useParams)().id,i.title,i.view),A=(i.edit,i.status,Object(ie.a)().setModalData,Object(O.a)()),x=A.startAddStep,T=A.setShowProModal,I=A.setShowProModalText,F=A.setShowAddStepModal,B=jt(Object(r.useState)({}),2),L=B[0],z=B[1],U=jt(Object(r.useState)(f),2),M=U[0],R=U[1];Object(r.useEffect)((function(){C||0!==Object(a.size)(j)||"no_bump"in f||R(pt(pt({},M),{},{no_bump:{label:Object(u.__)("No Order Bump","funnel-builder"),label_class:"bwf-st-c-badge-red"}}))}),[j.length]);var q=Object(b.fb)("wc_order_bump");return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-card-container"},S(),Object(r.createElement)("div",{className:"bwf-st-c-title"},Object(r.createElement)("div",{className:"bwf-st-c__step-type"},Object(u.__)("Checkout","funnel-builder")),Object(r.createElement)("span",{style:{color:"#353030"}},Object(u.__)("No Checkout Created","funnel-builder"))),Object(r.createElement)("div",null),Object(r.createElement)("div",{className:"bwf-card-controls"},Object(r.createElement)("span",{className:"bwf-card-action",style:{minWidth:"110px"}}),Object(r.createElement)("div",{className:"bwf-card-action"},Object(r.createElement)(s.Button,{isSecondary:!0,className:"bwf-btn-small",onClick:function(){Object(_.k)({importType:"step"}),F(!0)}},Object(u.__)("Create Checkout","funnel-builder"))))),null!==q&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-sub-st-wrap"},Object(a.size)(j)>0&&j.map((function(e,t){return Object(r.createElement)(ke,{key:t,bump:e,checkoutStep:w,checkoutPos:h,stepPos:t,view:Object(V.decodeEntities)(P)})})),Object(r.createElement)("div",{className:"bwf-st-c-sub-st-action-wrap"},Object(r.createElement)(s.Button,{isSecondary:!0,onClick:function(e){N?z({bump:!0}):function(e){null!==q&&x(pt(pt({},q),{},{parent_id:parseInt(y),is_substep:!0,title:Object(u.__)("Order Bump","funnel-builder")})),!q&&T(!0),!q&&I(Object(u.__)("Order Bump is a part of Funnel Builder Pro","funnel-builder")),e.preventDefault()}(e)}},N&&Object(r.createElement)(m.a,{icon:"king",color:$.NOTICE_YELLOW,size:20}),Object(u.__)("Add Order Bump","funnel-builder"))))),E&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-st-c-sub-st-wrap is-ob-fake"},Object(r.createElement)(K,{type:"order_bump",onClick:function(){return T(!0)},modalContent:{title:Object(u.__)("Order Bump","funnel-builder"),content:{benefits:[Object(u.__)("Eye-catching bump styles","funnel-builder"),Object(u.__)("Targeted offers based on cart contents","funnel-builder"),Object(u.__)("Increased product discoverability","funnel-builder")]},image:Object(b.T)()+"order-bump.png",proLink:Object(b.U)(["Order","Bump","Upgrade","Modal"])}}))),L.bump&&Object(r.createElement)(Ce.a,{isOpen:L.bump,onRequestClose:function(){return z({status:!1})}}))},wt=["step","step","provided","isDragging"];function gt(){return(gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var _t=Object(q.c)((function(){return Object(r.createElement)("span",{title:"Click here and start drag and drop",className:"bwf-d-icon-drag"},Object(r.createElement)(m.a,{icon:"rearrange",size:"16"}))})),ht=function(e){var t=e.step,n=void 0===t?{}:t,c=n.type,l=n.experiment,i=void 0===l?[]:l,o=e.step,s=e.provided,f=e.isDragging,m=function(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(e,wt),p=Object(b.db)(c);if(!o)return null;var O=function(){return Object(r.createElement)(_t,{provided:s})};return Object(r.createElement)("div",gt({className:d()("bwf-st-c-wrap",{"is-dragging":f}),ref:s.innerRef},s.draggableProps),Object(r.createElement)("div",{className:"bwf-st-c"},0<Object(a.size)(i)&&Object(r.createElement)("div",{className:"bwf-ab-tag"},Object(r.createElement)("div",{className:"bwf-ab--text"},Object(u.__)("A/B","funnel-builder"))),function(){switch(c){case"wc_checkout":return Object(r.createElement)(Re,gt({step:o,title:null==p?void 0:p.title},m,{dragHandleController:O}));case"wc_native":return Object(r.createElement)(yt,gt({step:o,title:Object(u.__)("Checkout Page","funnel-builder")},m,{dragHandleController:O}));default:return Object(r.createElement)(ft,gt({step:o,title:null==p?void 0:p.title},m,{dragHandleController:O}))}}()))},Et=Object(q.b)(ht);function St(){return(St=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var kt=Object(q.a)((function(e){var t=e.items,n=e.stepPromotions,c=e.provided,a=Object(D.b)().isLite,l=Object(D.b)("ul").isLite,i=!1,o=!1;return Object(r.createElement)("div",St({className:"bwf-f-steps",ref:c.innerRef},c.droppableProps),t.map((function(e,t){return Object(r.createElement)(r.Fragment,{key:"bwf-st-c-".concat(t)},Object(r.createElement)(Et,{key:"item-".concat(e.id),index:t,step:e,id:e.id,stepPos:t,isOBFake:!(!["wc_checkout","wc_native"].includes(e.type)||"yes"===n.bump)&&!(o||!a||Object(b.fb)("wc_order_bump")||(o=!0,0))}),["wc_checkout","wc_native"].includes(e.type)&&"yes"!==n.upsell&&(!i&&l?(i=!0,Object(r.createElement)(r.Fragment,null,Object(r.createElement)(K,{modalContent:{title:Object(u.__)("One Click Upsell Offer","funnel-builder"),content:{benefits:[Object(u.__)("Grab buyer's attention and make post purchase One Click Upsells based on items purchased. Let them accept offers with a single click.","funnel-builder")]},image:Object(b.T)()+"upsell.png",proLink:Object(b.U)(["One","Click","Upsell","Upgrade","Modal"])}}))):""))})))}));function Nt(e){return function(e){if(Array.isArray(e))return Ct(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ct(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ct(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Pt=function(){var e=Object(D.b)().isBasic,t=function(){return Object(r.createElement)("div",{className:"bwf-st-c-wrap bwf-w-full"},Object(r.createElement)("div",{className:"bwf-st-c bwf-flex bwf-w-full",style:{padding:"10px 16px"}},Object(r.createElement)("div",{className:"bwf-flex bwf--g16"},Object(r.createElement)(be.a,{h:16,w:16}),Object(r.createElement)("div",null,Object(r.createElement)(be.a,{h:16,w:80}),Object(r.createElement)(be.a,{h:16,w:250,mt:6}))),Object(r.createElement)("div",{className:"bwf-flex bwf--g16",style:{marginRight:150,marginLeft:"auto"}},e?null:Nt(Array(3)).map((function(e,t){return Object(r.createElement)("div",{key:"analytics-placeholder-".concat(t),style:{width:120}},Object(r.createElement)(be.a,{h:12,w:24,ml:"auto",mr:"auto"}),Object(r.createElement)(be.a,{h:12,w:60,mt:4,ml:"auto",mr:"auto"}))}))),Object(r.createElement)(be.a,{h:30,w:172})))};return Object(r.createElement)("div",{className:"bwf-steps-container"},Object(r.createElement)("div",{className:"bwf-f-steps is-placeholder"},Nt(Array(4)).map((function(e,n){return Object(r.createElement)(r.Fragment,{key:"step-card-".concat(n)},t())}))))},At=n(297),xt=(n(665),n(14));function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e){return function(e){if(Array.isArray(e))return Ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||zt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(n),!0).forEach((function(t){Bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Tt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Tt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||zt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){if(e){if("string"==typeof e)return Ut(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ut(e,t):void 0}}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Mt=function(e){var t=Lt(Object(r.useState)([]),2),n=t[0],c=t[1],l=Lt(Object(r.useState)([]),2),i=l[0],f=l[1],d=Lt(Object(r.useState)([]),2),p=d[0],v=d[1],y=Lt(Object(r.useState)(!1),2),g=y[0],_=y[1],h=Lt(Object(r.useState)(!1),2),E=h[0],S=h[1],k=Lt(Object(r.useState)(!0),2),N=k[0],C=k[1],P=Lt(Object(r.useState)([]),2),A=P[0],x=P[1],T=e.isOpen,I=e.onRequestClose,F=e.funnelID,B=(e.stepsListTypes,Object(D.c)().showSnackbar),L=j.a.getFunnel(),z=(j.a.getFunnelSteps(),Object(O.a)().setUpdateFunnel);Object(r.useEffect)((function(){var e=[];A.map((function(t){[0,"0"].includes(t.status)&&e.push({type:t.type,id:Number(t.id)}),Object(a.size)(t.subStep)&&t.subStep.map((function(n){[0,"0"].includes(n.status)&&e.push({type:n.type,id:Number(n.id),subParentId:Number(t.id)})}))})),v(e)}),[A]);Object(r.useEffect)((function(){if(Object(a.size)(L.steps)){var e=L.steps.map((function(e){var t,n,r,c,l;return{type:null==e?void 0:e.type,id:null==e?void 0:e.id,title:null==e||null===(t=e._data)||void 0===t?void 0:t.title,status:null==e||null===(n=e._data)||void 0===n?void 0:n.status,subStep:(r=e,"wc_checkout"===(null==r?void 0:r.type)&&Object(a.size)(null==r?void 0:r.substeps)?null==r||null===(c=r.substeps)||void 0===c||null===(c=c.wc_order_bump)||void 0===c?void 0:c.map((function(e){var t,n;return{type:"bump",id:null==e?void 0:e.id,title:null==e||null===(t=e._data)||void 0===t?void 0:t.title,status:null==e||null===(n=e._data)||void 0===n?void 0:n.status}})):"wc_upsells"===(null==r?void 0:r.type)&&Object(a.size)(null==r?void 0:r.substeps)?null==r||null===(l=r.substeps)||void 0===l||null===(l=l.offer)||void 0===l?void 0:l.map((function(e){var t,n;return{type:"Offer",id:null==e?void 0:e.id,title:null==e||null===(t=e._data)||void 0===t?void 0:t.title,status:null==e||null===(n=e._data)||void 0===n?void 0:n.status}})):[])}})).filter((function(e){var t,n=null==e||null===(t=e.subStep)||void 0===t?void 0:t.filter((function(e){return[0,"0"].includes(e.status)}));return[0,"0"].includes(e.status)||Object(a.size)(e.subStep)&&Object(a.size)(n)?e:void 0}));x(e)}}),[]);var U=function(e,t){c((function(e){return[].concat(It(e),[t])}));var n="";n="/funnel-".concat(e,"/save-state/").concat(t,"?funnel_id=").concat(F),o()({path:Object(b.y)(n),method:"POST",data:{status:!0}}).then((function(e){var n,r;e.success?(c((function(e){return[e.filter((function(e){return e!==t}))]})),f((function(e){return[].concat(It(e),[t])})),e.step_data.hasOwnProperty("upsell_id")&&(n=e.step_data.upsell_id,r="offer"),e.step_data.hasOwnProperty("checkout_id")&&(n=e.step_data.checkout_id,r="wc_order_bump"),function(e,t,n,r){var c=null==L?void 0:L.steps.map((function(c){if(n&&c.id===Number(n)){var a=c.substeps[r].map((function(e){var n=Ft(Ft({},e._data),{},{status:t.includes(e.id)?"1":e._data.status});return Ft(Ft({},e),{},{_data:n})})),l=Ft(Ft({},c.substeps),{},Bt({},r,a));return Ft(Ft({},c),{},{substeps:l})}if(t.includes(c.id)){var i=Ft(Ft({},c._data),{},{status:e?"1":"0"});return Ft(Ft({},c),{},{_data:i})}return c}));L.steps=c;var a=JSON.parse(JSON.stringify(L));z(a)}(!0,[t],n,r)):(e.message||e.msg)&&B(e.message||e.msg)})).catch((function(e){console.log(e),B(Object(u.__)("Status Updation Failed","funnel-builder"))}))},M=function(){_(!0);var e="/funnels/".concat(F,"/publish-all");o()({path:Object(b.y)(e),method:"POST",data:{steps:JSON.stringify(p)}}).then((function(e){e.status?(Object(a.size)(e.steps)&&p.map((function(e){var t=null==L?void 0:L.steps.map((function(t){if(t.id===e.subParentId){var n=t.substeps["Offer"===e.type?"offer":"wc_order_bump"].map((function(t){var n=Ft(Ft({},t._data),{},{status:Number(e.id)===Number(t.id)?"1":t._data.status});return Ft(Ft({},t),{},{_data:n})})),r=Ft(Ft({},t.substeps),{},Bt({},"Offer"===e.type?"offer":"wc_order_bump",n));return Ft(Ft({},t),{},{substeps:r})}if(Number(e.id)===Number(t.id)){var c=Ft(Ft({},t._data),{},{status:"1"});return Ft(Ft({},t),{},{_data:c})}return t}));L.steps=t;var n=JSON.parse(JSON.stringify(L));z(n)})),_(!1),S(!0)):(e.message||e.msg)&&B(e.message||e.msg)})).catch((function(e){console.log(e),B(Object(u.__)("Status Updation Failed","funnel-builder"))}))};return Object(r.useEffect)((function(){var e=0;A.map((function(t){[0,"0"].includes(t.status)&&(e+=1),t.subStep.map((function(t){[0,"0"].includes(t.status)&&(e+=1)}))})),e&&e<2&&C(!1)}),[A,L]),T&&Object(r.createElement)("div",null,Object(r.createElement)(s.Modal,{className:"bwf-admin-modal bwf-publish-modal bwf-admin-modal-squeezy bwf-admin-modal-no-header",isDismissible:!0,onRequestClose:function(){return I()}},Object(r.createElement)("div",{className:"bwf-custom-header bwf-flex bwf--space-between bwf-mb-16"},Object(r.createElement)("div",{className:"bwf-modal-title"},Object(u.__)("Publish Steps","funnel-builder")),Object(r.createElement)("div",{className:"bwf-modal-action bwf-flex bwf--g24"},!E&&N&&Object(r.createElement)("div",{className:"bwf-btn-small is-primary components-button",onClick:function(){return M()}},Object(r.createElement)("span",{style:Ft({},g&&{visibility:"hidden"})},Object(u.__)("Publish All","funnel-builder")),g&&Object(r.createElement)(w.a,{color:"#ffffff",style:{position:"absolute"}})),Object(r.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",title:Object(u.__)("Close"),onClick:function(){return I()}},Object(r.createElement)(m.a,{icon:"close",height:20,width:20})))),Object(r.createElement)("div",{className:"bwf-info"},Object(u.__)("Following steps need to publish to make accessible to your customers:","funnel-builder")),A.map((function(e,t){var c;return Object(r.createElement)("div",{key:t,className:"bwf-draft-list"},Object(r.createElement)("div",{className:"bwf-title"},Object(V.decodeEntities)(e.title)),Object(r.createElement)(ne.c,{content:"wc_upsells"===e.type?Object(u.__)("One Click Upsell","funnel-builder"):Object(b.sb)(e.type)}),n.includes(e.id)&&Object(r.createElement)("div",{className:"bwf-btn-small bwf-h-30 bwf-loading-btn is-secondary components-button bwf-ripple ".concat([0,"0"].includes(e.status)?"":"bwf-visibility-hidden")},Object(r.createElement)(w.a,{color:"#0073aa",style:{position:"absolute"}})),!n.includes(e.id)&&(E||i.includes(e.id))&&Object(r.createElement)("div",{className:"is-publish bwf-publish-btn components-button ".concat([0,"0"].includes(e.status)?"":"bwf-visibility-hidden")},Object(r.createElement)(m.a,{icon:"check-circle",size:"16"}),Object(r.createElement)("span",null,Object(u.__)("Published","funnel-builder"))),!E&&!n.includes(e.id)&&!i.includes(e.id)&&Object(r.createElement)("div",{className:"bwf-btn-small bwf-h-30 bwf-t-right is-secondary components-button ".concat([0,"0"].includes(e.status)?"":"bwf-visibility-hidden"),onClick:function(){return U(e.type,e.id)}},Object(u.__)("Publish","funnel-builder")),Object(a.size)(e.subStep)&&Object(a.size)(null==e||null===(c=e.subStep)||void 0===c?void 0:c.filter((function(e){return[0,"0"].includes(e.status)})))?e.subStep.map((function(e,t){if([0,"0"].includes(e.status))return Object(r.createElement)(r.Fragment,{key:t},Object(r.createElement)("div",{className:"bwf-title bwf-sub-step"},Object(r.createElement)("span",null,Object(V.decodeEntities)(e.title))),Object(r.createElement)(ne.c,{content:Object(b.sb)(e.type)}),n.includes(e.id)&&Object(r.createElement)("div",{className:"bwf-btn-small bwf-h-30 bwf-loading-btn is-secondary bwf-ripple components-button".concat([0,"0"].includes(e.status)?"":"bwf-visibility-hidden")},Object(r.createElement)(w.a,{color:"#0073aa",style:{position:"absolute"}})),!n.includes(e.id)&&(E||i.includes(e.id))&&Object(r.createElement)("div",{className:"is-publish bwf-publish-btn components-button ".concat([0,"0"].includes(e.status)?"":"bwf-visibility-hidden")},Object(r.createElement)(m.a,{icon:"check-circle",size:"16"}),Object(r.createElement)("span",null,Object(u.__)("Published","funnel-builder"))),!E&&!n.includes(e.id)&&!i.includes(e.id)&&Object(r.createElement)("div",{className:"bwf-btn-small bwf-h-30 bwf-t-right is-secondary bwf-ripple components-button ".concat([0,"0"].includes(e.status)?"":"bwf-visibility-hidden"),onClick:function(){return U(e.type,e.id)}},Object(u.__)("Publish","funnel-builder")))})):null)}))))},Rt=n(163),qt=n(89),Gt=(n(666),n(85)),Jt=(n(667),n(288));function $t(e){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ht(e){return function(e){if(Array.isArray(e))return Xt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Vt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(n),!0).forEach((function(t){Wt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wt(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=$t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$t(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||Vt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(e,t){if(e){if("string"==typeof e)return Xt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xt(e,t):void 0}}function Xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Zt={bump:{texts:{heading:Object(u.__)("Maximize Your Checkout Revenue with an Order Bump!","funnel-builder"),description:Object(u.__)("Increase the overall value of your checkout by offering a new products as an order bump.","funnel-builder")},actions:[{label:Object(u.__)("Add Order Bump","funnel-builder"),key:"bump"}],icon:"order-bump",link:"https://funnelkit.com/woocommerce-order-bump/"},upsell:{texts:{heading:Object(u.__)("Offer More with a One-Click Upsell!","funnel-builder"),description:Object(u.__)("Let customers buy more products after they've made their purchase.","funnel-builder")},actions:[{label:Object(u.__)("Add One Click Upsell","funnel-builder"),key:"upsell"}],icon:"upsells",link:"https://funnelkit.com/woocommerce-one-click-upsells-upstroke/"},both:{texts:{heading:Object(u.__)("Maximize Your Revenue with an Order Bump and Upsell!","funnel-builder"),description:Object(u.__)("Increase the overall value of your orders by offering new products as an order bump or upsell offer.","funnel-builder")},actions:[{label:Object(u.__)("Add One Click Upsell","funnel-builder"),key:"upsell"},{label:Object(u.__)("Add Order Bump","funnel-builder"),key:"bump"}],icon:"order-bump"}},en="add_bump_upsell_notice",tn=function(e){var t=e.onRequestClose,n=e.onConfirm,c=(0,j.a.getFunnel)(),l=Kt(Object(r.useState)(null),2),i=l[0],o=l[1],b=Object(a.get)(c,"steps",[]).filter((function(e){return"wc_checkout"===e.type||"wc_native"===e.type})).map((function(e){return{label:"wc_native"===e.type?Object(u.__)("Checkout Page","funnel-builder"):Object(a.get)(e,"_data.title",""),key:e.id}})),f=Kt(Object(r.useState)(1===b.length?Object(a.get)(b,"[0].key",null):null),2),d=f[0],m=f[1];return Object(r.createElement)(s.Modal,{title:Object(u.__)("Create Order Bump","funnel-builder"),onRequestClose:t,className:"bwf-admin-modal bwf-admin-modal-squeezy bwf-create-order-bump-modal"},Object(r.createElement)(Jt.b,{label:Object(u.__)("Select Checkout","funnel-builder"),options:b,selected:d,onChange:function(e){i&&o(null),m(e)},className:"bwf-error-border",error:i}),Object(r.createElement)("div",{className:"bwf-flex bwf--justify-end bwf--g8"},Object(r.createElement)(xt.a,{onClick:t,className:"bwf-modal-cancel-btn"},Object(u.__)("Cancel","funnel-builder")),Object(r.createElement)(xt.a,{isPrimary:!0,onClick:function(){null!==d?(o(null),n(d)):o(Object(u.__)("Please select a checkout step","funnel-builder"))}},Object(u.__)("Next","funnel-builder"))))},nn=function(e){var t=e.steps,n=t.some((function(e){return"wc_checkout"===e.type||"wc_native"===e.type})),c=t.some((function(e){var t;return"wc_upsells"===e.type&&!Object(a.isEmpty)(null==e||null===(t=e.substeps)||void 0===t?void 0:t.offer)})),l=t.some((function(e){var t;return("wc_checkout"===e.type||"wc_native"===e.type)&&!Object(a.isEmpty)(null==e||null===(t=e.substeps)||void 0===t?void 0:t.wc_order_bump)})),i=n&&!l,o=n&&!c,s=Zt[i&&o?"both":i?"bump":o?"upsell":""]||Zt.both,f=s.texts,d=s.actions,p=s.icon,j=s.link,y=Kt(Object(r.useState)(!1),2),w=y[0],g=y[1],h=Object(v.a)().setActiveGroup,E=Object(O.a)().startAddStep,S=Object(b.fb)("wc_order_bump"),N=Object(J.a)().setClosedNotices,C=(0,Object(k.a)().getClosedNotices)();return C.includes(en)||!i&&!o?null:Object(r.createElement)("div",{className:"bwf-add-bump-upsell-notice bwf-flex bwf--g16 bwf--space-between"},Object(r.createElement)("div",{className:"bwf-flex bwf--g8  bwf--align-start"},Object(r.createElement)("div",{className:"bwf-add-bump-upsell-notice__icon"},Object(r.createElement)(m.a,{icon:p,size:32,color:$.TEXT_COLOR_2})),Object(r.createElement)("div",null,Object(r.createElement)("span",{className:"bwf-text-bold"},f.heading),Object(r.createElement)("br",null),Object(r.createElement)("span",null,f.description," ",j&&Object(r.createElement)("a",{href:j,className:"bwf-text-bold",target:"_blank",rel:"noopener noreferrer"},Object(u.__)("Learn More","funnel-builder"))))),Object(r.createElement)("div",{className:"bwf-flex bwf--g24"},Object(r.createElement)("div",{className:"bwf-flex bwf--g12"},d.map((function(e,t){return Object(r.createElement)(xt.a,{key:t,className:"is-black is-small",onClick:function(){return function(e){if("upsell"===e)return h("upsell"),void Object(_.k)({importType:"step"});g(!0)}(e.key)}},e.label)}))),Object(r.createElement)(xt.a,{className:"bwf-no-style-button",onClick:function(){Object(b.qb)(en).then((function(e){var t=[].concat(Ht(C),[en]);N(t)})).catch((function(e){console.log("Error deleting Notice: ",e)}))}},Object(r.createElement)(m.a,{icon:"cross",size:16}))),w&&Object(r.createElement)(tn,{onRequestClose:function(){return g(!1)},onConfirm:function(e){E(Yt(Yt({},S),{},{parent_id:parseInt(e),is_substep:!0,title:"Order Bump"}))}}))};function rn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return cn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var an=function(e){e.funnelId;var t=e.steps,n=rn(Object(r.useState)(!1),2),c=n[0],a=n[1],l=Object(D.c)().showSnackbar,i=Object(O.a)().setFunnelSteps;return Object(r.createElement)(s.Notice,{status:"info",isDismissible:!1,className:"bwf-component-notice bwf-store-checkout-header-error-notice"},Object(r.createElement)("div",{className:"bwf-flex bwf--g4 bwf--align-start"},Object(r.createElement)("span",{className:"bwf-flex"},Object(r.createElement)(m.a,{icon:"info",style:{margin:0},color:$.DANGER_COLOR})),Object(r.createElement)("p",{className:"bwf-notice-content"},Object(u.__)("Order bumps and One-click upsell offers will not work because your checkout is created using the","funnel-builder"),Object(r.createElement)("strong",null,Object(u.__)(" block editor. ","funnel-builder")),Object(u.__)("You need to create the checkout using FunnelKit.","funnel-builder"))),Object(r.createElement)(xt.a,{className:"is-danger",onClick:function(){a(!0),o()({path:Object(b.y)("/notifications/wc_block_incompat"),method:"POST"}).then((function(e){if(!e.success)throw e;var n=t.map((function(e){return"wc_native"===e.type&&(e.is_checkout_block=!1),e}));i(n),a(!1)})).catch((function(e){console.log(e),a(!1),l(e.message)}))},isBusy:c,disabled:c,isSmall:!0},Object(u.__)("Switch to Classic Checkout","funnel-builder")))};function ln(e){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function on(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",c=n.toStringTag||"@@toStringTag";function a(n,r,c,a){var o=r&&r.prototype instanceof i?r:i,s=Object.create(o.prototype);return sn(s,"_invoke",function(n,r,c){var a,i,o,s=0,u=c||[],b=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,i=0,o=e,f.n=n,l}};function d(n,r){for(i=n,o=r,t=0;!b&&s&&!c&&t<u.length;t++){var c,a=u[t],d=f.p,m=a[2];n>3?(c=m===r)&&(o=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=d&&((c=n<2&&d<a[1])?(i=0,f.v=r,f.n=a[1]):d<m&&(c=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,f.n=m,i=0))}if(c||n>1)return l;throw b=!0,r}return function(c,u,m){if(s>1)throw TypeError("Generator is already running");for(b&&1===u&&d(u,m),i=u,o=m;(t=i<2?e:o)||!b;){a||(i?i<3?(i>1&&(f.n=-1),d(i,o)):f.n=o:f.v=o);try{if(s=2,a){if(i||(c="next"),t=a[c]){if(!(t=t.call(a,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(o=TypeError("The iterator does not provide a '"+c+"' method"),i=1);a=e}else if((t=(b=f.n<0)?o:n.call(r,f))!==l)break}catch(t){a=e,i=1,o=t}finally{s=1}}return{value:t,done:b}}}(n,c,a),!0),s}var l={};function i(){}function o(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(sn(t={},r,(function(){return this})),t),b=s.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,sn(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e}return o.prototype=s,sn(b,"constructor",s),sn(s,"constructor",o),o.displayName="GeneratorFunction",sn(s,c,"GeneratorFunction"),sn(b),sn(b,c,"Generator"),sn(b,r,(function(){return this})),sn(b,"toString",(function(){return"[object Generator]"})),(on=function(){return{w:a,m:f}})()}function sn(e,t,n,r){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}(sn=function(e,t,n,r){if(t)c?c(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){sn(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}})(e,t,n,r)}function un(e,t,n,r,c,a,l){try{var i=e[a](l),o=i.value}catch(e){return void n(e)}i.done?t(o):Promise.resolve(o).then(r,c)}function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ln(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ln(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(e){var t=Object(D.b)(),n=t.isProFeatureLocked,i=t.isLite,f=Object(c.useParams)(),d=f.id,p=f.builder,y=f.filter,w=e.funnelId,E=void 0===w?d:w,S=location&&location.search?Object(l.parse)(location.search.substring(1)):{},N=Object(Rt.a)().resetFlowData,C=Object(qt.a)().resetCanvasData,P=S.importType,A=Object(O.a)(),x=A.fetch,T=A.sortSteps,F=A.updateFunnelViewLink,B=A.setShowProModal,L=A.setShowAddStepModal,z=A.setIsFunnelEmpty,U=A.setFunnelSteps,q=A.setLoading,G=A.setLanguageData,J=A.fetchAnalytics,$=Object(r.useRef)(!0),H=j.a.getFunnelID,Q=j.a.getFunnel,Y=j.a.getFunnelLoading,W=j.a.getFunnelError,K=j.a.getShowProModal,V=j.a.getShowAddStepModal,X=j.a.getIsFunnelEmpty,Z=j.a.getAnalyticsLoaded,ee=j.a.getIsFunnelLoading,te=H(),ne=Q(),re=ee(),ce=Z(),ae=Y(),le=W(),ie=K(),oe=V(),ue=X(),be=(0,Object(k.a)().getStepPromotion)(),fe=Object(se.a)().setControlTitle,de=mn(Object(r.useState)(!1),2),me=de[0],pe=de[1],Oe=Object(D.c)(),je=Oe.showSnackbar,ve=(Oe.hideSnackbar,mn(Object(r.useState)(!1),2)),ye=ve[0],we=ve[1],ge=mn(Object(r.useState)(!1),2),_e=ge[0],he=ge[1],Ee=mn(Object(r.useState)(""),2),Se=Ee[0],ke=Ee[1],Ne=mn(Object(r.useState)([]),2),Pe=Ne[0],Ae=Ne[1],xe=mn(Object(r.useState)({}),2),Te=(xe[0],xe[1]),Ie=mn(Object(r.useState)([]),2),De=Ie[0],Fe=Ie[1],Be=Object(b.kb)(),Le=Object(v.a)().setActiveGroup,ze=Object(r.useRef)();Object(r.useEffect)((function(){var e=JSON.stringify(null==ne?void 0:ne.steps),t=ze.current;null!=ne&&ne.steps&&t&&e!==t&&G({isLoading:!0}),ze.current=e}),[null==ne?void 0:ne.steps]),Object(r.useEffect)((function(){(parseInt(te)!==parseInt(E)||Object(a.isEmpty)(ne))&&(q(!0),x(parseInt(E)))}),[]),Object(r.useEffect)((function(){n||Object(a.isEmpty)(null==ne?void 0:ne.steps)||ce||re||J(te)}),[re]),Object(r.useEffect)((function(){fe(null),we(!1)}),[ae]);var Ue=function(e,t){return e.filter((function(e){return e.type===t}))},Me=function(){var e="";if(!Be&&!ae&&!me&&ne&&ne.steps&&ne.steps.length&&Array.isArray(ne.steps)){var t=Object(a.size)(Ue(ne.steps,"wc_checkout")),n=Ue(ne.steps,"wc_thankyou"),r=Ue(ne.steps,"wc_upsells");t?t&&(function(e){for(var t=!1,n=e.length-1;n>=0;n--)"wc_upsells"===e[n].type?t=!0:"wc_checkout"===e[n].type&&(t=!1);return t}(ne.steps)||function(e){for(var t=!1,n=e.length-1;n>=0;n--)"wc_thankyou"===e[n].type?t=!0:"wc_checkout"===e[n].type&&(t=!1);return t}(ne.steps)?(Object(a.size)(n)&&Object(a.size)(r)?e="".concat(Object(u.__)("Make sure that your <strong>Thank You</strong> step and <strong>One-Click Upsell offers</strong> step are placed below the <strong>checkout</strong> step.","funnel-builder")):Object(a.size)(n)?e="".concat(Object(u.__)("Make sure that your <strong>Thank You</strong> step is placed below the <strong>checkout</strong> step.","funnel-builder")):Object(a.size)(r)&&(e="".concat(Object(u.__)("Make sure that your <strong>One-Click Upsell offers</strong> step is placed below the <strong>checkout</strong> step.","funnel-builder"))),ke(e)):ke("")):function(e){var t=Ue(e,"wc_thankyou"),n=Ue(e,"wc_upsells"),r="";Object(a.size)(t)&&Object(a.size)(n)?r="".concat(Object(u.__)("To trigger <strong>Thank You</strong> and <strong>One Click Upsell offers</strong> steps, you need to create a <strong>Checkout step</strong>.","funnel-builder")):Object(a.size)(t)&&!Object(a.size)(n)?r="".concat(Object(u.__)("To trigger <strong>Thank You</strong> step, you need to create a <strong>Checkout step</strong>.","funnel-builder")):!Object(a.size)(t)&&Object(a.size)(n)&&(r="".concat(Object(u.__)("To trigger <strong>One Click Upsell offers</strong> step, you need to create a <strong>Checkout step</strong>.","funnel-builder"))),ke(r)}(ne.steps)}};Object(r.useEffect)((function(){"step"!==P&&Me()}),[ne,me,P]),Object(r.useEffect)((function(){return function(){ue&&z(!1)}}),[]),Object(r.useEffect)((function(){P&&!Be&&(y?Le(y):"funnel"!==P||p?"step"===P&&!p&&$.current&&Le("wc_checkout"):Le("landing")),$.current&&($.current=!1)}),[P]);Object(r.useEffect)((function(){if(Object(a.size)(ne)){var e,t=null==ne||null===(e=ne.steps)||void 0===e?void 0:e.map((function(e){var t,n,r,c,l;return{type:null==e?void 0:e.type,id:null==e?void 0:e.id,title:null==e||null===(t=e._data)||void 0===t?void 0:t.title,status:null==e||null===(n=e._data)||void 0===n?void 0:n.status,subStep:(r=e,"wc_checkout"===(null==r?void 0:r.type)&&Object(a.size)(null==r?void 0:r.substeps)?null==r||null===(c=r.substeps)||void 0===c||null===(c=c.wc_order_bump)||void 0===c?void 0:c.map((function(e){var t,n;return{type:"bump",id:null==e?void 0:e.id,title:null==e||null===(t=e._data)||void 0===t?void 0:t.title,status:null==e||null===(n=e._data)||void 0===n?void 0:n.status}})):"wc_upsells"===(null==r?void 0:r.type)&&Object(a.size)(null==r?void 0:r.substeps)?null==r||null===(l=r.substeps)||void 0===l||null===(l=l.offer)||void 0===l?void 0:l.map((function(e){var t,n;return{type:"Offer",id:null==e?void 0:e.id,title:null==e||null===(t=e._data)||void 0===t?void 0:t.title,status:null==e||null===(n=e._data)||void 0===n?void 0:n.status}})):[])}})).filter((function(e){var t,n=null==e||null===(t=e.subStep)||void 0===t?void 0:t.filter((function(e){return[0,"0"].includes(e.status)}));return Object(a.size)(e.subStep)&&Object(a.size)(n)?e.subStep=n:[0,"0"].includes(e.status)?(e.subStep=[],e):void 0})),n=[];t.map((function(e){if("wc_checkout"===e.type&&[0,"0"].includes(e.status)&&n.push("wc_checkout"),"wc_upsells"===e.type&&[0,"0"].includes(e.status)&&n.push("wc_upsells"),"wc_checkout"===e.type&&Object(a.size)(e.subStep)){var t,r=null==e||null===(t=e.subStep)||void 0===t?void 0:t.filter((function(e){return[0,"0"].includes(e.status)}));Array(Object(a.size)(r)).fill("bump").forEach((function(){n.push("bump")}))}if("wc_upsells"===e.type&&Object(a.size)(e.subStep)){var c,l=null==e||null===(c=e.subStep)||void 0===c?void 0:c.filter((function(e){return[0,"0"].includes(e.status)}));Array(Object(a.size)(l)).fill("offer").forEach((function(){n.push("offer")}))}["wc_checkout","wc_upsells"].includes(e.type)||Object(a.size)(e.subStep)||n.push(e.type)}));var r=n.reduce((function(e,t){return fn(fn({},e),{},dn({},t,(e[t]||0)+1))}),{});Fe(n),Te(r),Ae(t),N(),C(),_e||U(null==ne?void 0:ne.steps)}}),[ne]);var Re=function(){var e,t=(e=on().m((function e(t){var n,r,c;return on().w((function(e){for(;;)switch(e.n){case 0:if(n=t.oldIndex,r=t.newIndex,n!==r){e.n=1;break}return e.a(2);case 1:return c=T(n,r),pe(!0),e.p=2,e.n=3,o()({path:Object(b.y)("/funnels/".concat(E)),method:"PUT",data:{steps:JSON.stringify(c.map((function(e){return{id:e.id,type:e.type}})))}});case 3:Object(b.kb)()||F(c.length>0?c[0]._data.view:""),je(Object(u.__)("Steps Updated","funnel-builder")),setTimeout((function(){return pe(!1)}),2e3),e.n=5;break;case 4:e.p=4,e.v,T(r,n),Object(b.kb)()||F(c.length>0?c[0]._data.view:""),je(Object(u.__)("Steps Updation Failed","funnel-builder")),setTimeout((function(){return pe(!1)}),2e3);case 5:return e.a(2)}}),e,null,[[2,4]])})),function(){var t=this,n=arguments;return new Promise((function(r,c){var a=e.apply(t,n);function l(e){un(a,r,c,l,i,"next",e)}function i(e){un(a,r,c,l,i,"throw",e)}l(void 0)}))});return function(e){return t.apply(this,arguments)}}();if(P&&!Be)return Object(r.createElement)(r.Fragment,null,"funnel"===P?Object(r.createElement)(h.default,{onImportComplete:function(){x(parseInt(E)),delete S.importType,delete S.group,Object(_.k)({},"/funnels/".concat(E),S)}}):Object(r.createElement)(g.a,{onImportComplete:function(){x(parseInt(E)),delete S.importType,delete S.group,Object(_.k)({},"/funnels/".concat(E),S)}}));if(!ye&&!ae&&!ue&&le)return Object(r.createElement)(Gt.a,{errorMessage:le.hasOwnProperty("message")?le.message:Object(u.__)("Unable to load Funnel Steps","funnel-builder")});var qe=[{type:"icon",data:{content:Object(r.createElement)(m.a,{icon:"zero-step-alt",width:"202",height:"151"})}},{type:"content",data:{class:"bwf-zero-state-heading-1",content:Object(u.__)("Start building your funnel","funnel-builder")}},{type:"content",data:{class:"bwf-zero-state-heading-2",content:Object(u.__)("Add a new step or pick a pre-built funnel","funnel-builder")}},{type:"buttons",data:{buttons:[{text:Object(u.__)("Add New Step","funnel-builder"),proCheck:!1,onClick:function(){Object(_.k)({importType:"step"}),Le("landing"),Be&&L(!0)}},{text:Object(u.__)("View Funnels","funnel-builder"),proCheck:!1,props:{isPrimary:!1,isSecondary:!0},onClick:function(){Be?(L(!0),Object(_.k)({importType:"wc_checkout"})):Object(_.k)({importType:"funnel"})}}]}}];if(!(ne&&ne.hasOwnProperty("steps")&&Object(a.isArray)(ne.steps)&&0!==Object(a.size)(ne.steps)||ae||ye))return Object(r.createElement)(At.a,{data:qe});return Object(r.createElement)(r.Fragment,null,ye||ae?Object(r.createElement)(Pt,null):Object(r.createElement)(r.Fragment,null,function(){var e=null;if(Object(b.kb)()&&Object(a.some)(ne.steps,{type:"wc_native"}))if(Object(a.some)(ne.steps,(function(e){return"wc_native"===e.type&&e.is_checkout_block}))){var t=Object(a.some)(ne.steps,{type:"wc_upsells"}),n=Object(a.some)(ne.steps,(function(e){var t;return"wc_native"===e.type&&(null==e||null===(t=e.substeps)||void 0===t?void 0:t.wc_order_bump)}));(t||n)&&(e=Object(r.createElement)(an,{funnelId:E,steps:ne.steps}))}else e=Object(r.createElement)(r.Fragment,null,Object(r.createElement)(s.Notice,{status:"warning",isDismissible:!1,className:"bwf-component-notice"},Object(r.createElement)("div",{className:"bwf-flex bwf--g12 bwf--align-start"},Object(r.createElement)("span",{className:"bwf-flex"},Object(r.createElement)(m.a,{icon:"shield",style:{margin:0}})),Object(r.createElement)("p",{className:"bwf-notice-content"},Object(u.__)("You are using the default WooCommerce checkout page. Order bumps, upsell & thank you pages will work with the default checkout page. However, we recommend adding an optimized checkout page from FunnelKit.","funnel-builder")))),Object(r.createElement)("div",{className:"bwf_clear_20"}));return e}(),Object(r.createElement)("div",{className:"bwf-steps-container"},!i&&Object(r.createElement)(nn,{steps:ne.steps}),Object(a.size)(Se)?Object(r.createElement)("div",{className:"bwf-publish-container bwf-no-action"},Object(r.createElement)("div",{className:"bwf-flex bwf--g8"},Object(r.createElement)(m.a,{icon:"info",size:16}),Object(r.createElement)("span",{dangerouslySetInnerHTML:{__html:Se}}))):null,Object(r.createElement)(kt,{items:ne.steps,onSortEnd:Re,helperClass:"bwf-steps-drag__helper",stepPromotions:be}))),Object(r.createElement)(M,{funnelId:E}),Object(r.createElement)(R.a,{funnelId:E}),ie&&Object(r.createElement)(Ce.a,{isOpen:ie,onRequestClose:function(){return B(!1)}}),Object(r.createElement)(I,{query:S,isOpen:oe,setModalOpenState:function(e){L(e)},hasCheckoutStep:ne&&ne.steps&&Object(a.isArray)(ne.steps)&&ne.steps.some((function(e){return"wc_checkout"===e.type})),funnelId:E}),_e&&Object(r.createElement)(Mt,{isOpen:_e,stepsList:Pe,funnelID:E,stepsListTypes:De,onRequestClose:function(){return he(!1)}}))}},297:function(e,t,n){"use strict";var r=n(0),c=n(6),a=n.n(c),l=n(2),i=n(8),o=n(55),s=(n(304),n(5));function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.a=function(e){var t=e.data,n=void 0===t?[]:t,c=e.className,f=e.center,d=void 0!==f&&f,m=e.isDismissive,p=void 0!==m&&m,O=e.onDismisal,j=void 0===O?function(){}:O,v=e.isProFeatureLocked;if(Object(l.isEmpty)(n))return!1;return Object(r.createElement)("div",{className:a()("bwf-zero-state",c,{"bwf-block-t-center":d})},p&&Object(r.createElement)("span",{className:"bwf-layout-dismiss",onClick:function(){return j()},style:{transform:"rotate(45deg)"}},Object(r.createElement)(s.a,{icon:"plus",color:"#353030"})),Object(r.createElement)("div",{className:"bwf-zero-state-wrap"},n.map((function(e,t){return Object(r.createElement)(r.Fragment,{key:"section--"+t},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"icon":return Object(r.createElement)("div",{className:a()("bwf-zero-sec bwf-zero-sec-"+e,t.class)},t.content);case"actions":return Object(r.createElement)(o.a,{className:a()("bwf-zero-sec bwf-zero-sec-"+e,t.class),gap:4},t.actions.map((function(e,t){return Object(r.createElement)(o.a,{key:"layout-block-"+t,className:a()("bwf-shadow"),gap:3,onClick:e.onClick},Object(r.createElement)(o.c,null,Object(r.createElement)("div",{className:"bwf-circle-mockup"},e.icon)),Object(r.createElement)(o.b,{className:"bwf_text_left"},e.heading&&Object(r.createElement)("div",{className:"bwf-zero-sec-action-head",dangerouslySetInnerHTML:{__html:e.heading}}),e.sub_heading&&Object(r.createElement)("div",{className:"bwf-zero-sec-action-subhead",dangerouslySetInnerHTML:{__html:e.sub_heading}}),v&&Object(r.createElement)("div",{className:"bwf-zero-sec-lock"},Object(r.createElement)(s.a,{icon:"king",width:"18",height:"18"}))))})));case"buttons":return Object(r.createElement)(o.a,{className:a()("bwf-zero-sec bwf-zero-sec-"+e,t.class),gap:4},t.buttons.map((function(e,t){return Object(r.createElement)(i.Button,b({isPrimary:!e.isSecondary,key:t,onClick:e.onClick,className:a()("bwf-no-ripple",e.className,{"is-secondary":e.isSecondary})},e.props),!1!==e.proCheck&&v&&Object(r.createElement)("span",{className:"bwf-zero-sec-lock"},Object(r.createElement)(s.a,{icon:"king",width:"20",height:"20"})),e.text)})));default:return Object(r.createElement)("div",{className:a()("bwf-zero-sec bwf-zero-sec-"+e,t.class),style:t.style},t.content&&("object"===u(t.content)?t.content:Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:t.content}})))}}(e.type,e.data))}))))}},301:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return f}));var r=n(0),c=n(292);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var o=function(e){return function(t){return Object(r.createElement)(c.a,{onDragEnd:function(e){var n=e.destination,r=e.source;if(n){var c=Array.from(t.items),a=l(c.splice(r.index,1),1)[0];c.splice(n.index,0,a),t.onSortEnd&&t.onSortEnd({oldIndex:r.index,newIndex:n.index,items:c})}}},Object(r.createElement)(c.c,{droppableId:"droppable"},(function(n){return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(e,a({},n.droppableProps,t,{provided:n})),n.placeholder)})))}},s=["id","index"];function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var b=function(e){return function(t){var n=t.id,a=t.index,l=function(e,t){if(null==e)return{};var n,r,c=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}(t,s);return Object(r.createElement)(c.b,{draggableId:n.toString(),index:a,key:n},(function(t,n){return Object(r.createElement)(e,u({index:a,provided:t},l,{isDragging:n.isDragging}))}))}},f=function(e){return function(t){var n;return Object(r.createElement)("div",null===(n=t.provided)||void 0===n?void 0:n.dragHandleProps,Object(r.createElement)(e,t))}}},304:function(e,t,n){},350:function(e,t,n){"use strict";var r=n(0),c=n(126),a=n(2),l=n(1),i=n(376),o=n(298),s=n(81),u=n(312);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.a=function(e){var t=Object(o.a)(),n=t.getTemplates,b=t.getBuilders,d=t.getDefaultBuilder,m=t.templateLoading,O=t.getActiveBuilder,j=t.getActiveGroup,v=t.getCurrentTemplate,y=t.getActiveStep,w=t.getActiveSubFilter,g=e.onImportComplete,_=e.isStoreCheckout,h=e.storeCheckoutId,E=(e.hasCheckoutStep,e.urlDependency),S=void 0===E||E,k=e.stepId,N=e.funnelId,C=Object(s.a)(),P=C.setActiveGroup,A=(C.setActiveSubFilter,C.setCurrentTemplate),x=p(p({wc_checkout:Object(l.__)("Checkout","funnel-builder")},!_&&{landing:Object(l.__)("Sales","funnel-builder")}),{},{upsell:Object(l.__)("One Click Upsell Offers","funnel-builder"),wc_thankyou:Object(l.__)("Thank You","funnel-builder")},!_&&{optin:Object(l.__)("Optin","funnel-builder"),optin_ty:Object(l.__)("Optin Confirmation","funnel-builder")}),T=Object(c.useParams)(),I=T.id,D=T.filter,F=T.builder,B=T.templateId,L=f(Object(r.useState)(!1),2),z=L[0],U=L[1],M=n();Object(r.useEffect)((function(){return F&&(P(D),A({id:B})),function(){P("funnel")}}),[]);var R=function(e){return!(!e||!e.group_type)&&Object.keys(e.group_type)[0]};Object(r.useEffect)((function(){if(!Object(a.isEmpty)(M)&&!z&&F){var e=M[D][F][B];A({id:B,template:e}),U(!0)}}),[M]);var q=b(),G=d(),J=O(),$=m(),H=j(),Q=v(),Y=(y(),w()),W=function(){var e=G;return Object(a.isEmpty)(J)||(e=J),q&&q[H]&&!q[H][e]&&(e=q[H][G]?G:"elementor"),e},K=function(e,t,n){return("wc_checkout"===t||"optin"===t)&&Y&&J?M[t][J][e].group_type[n||Y]:e},V=function(e){return"wc_checkout"===H?Y===e.no_steps:"optin"!==H||e.group.includes(Y)},X=function(e,t,n){var r="";return"landing"===H?r="sp":"optin"===H?r="op":"optin_ty"===H?r="op-confirmed":"wc_checkout"===H?r="checkouts":"upsell"===H?r="offer":"wc_thankyou"===H&&(r="order-confirmed"),"oxy"===n&&(n="oxygen"),("customizer"===n||"wc_checkout"===H&&"wp_editor"===n)&&(n="elementor"),"https://templates-".concat(n,".funnelswp.com/").concat(r,"/").concat(t.prevslug,"/")},Z=_?"/store-checkout":0===I?"/templates":"/funnels/".concat(I);return Object(r.createElement)(i.a,{filters:u.e,templates:M,activeBuilder:W(),templateCards:function(){if(Object(a.isEmpty)(M)||Object(a.isEmpty)([H]))return{};var e=W(),t={};return M[H]&&M[H][e]&&(t=M[H][e]),t}(),editors:q,defaultBuilder:G,isTemplateLoading:$,activeTemplateGroup:H,templateGroup:x,previewData:function(){if(Object(a.isEmpty)(M)||"funnel"===H)return{};var e={},t=[],n=[];try{var r=W();for(var c in t=[],M[H][r]){var l=M[H][r][c];if(!l.build_from_scratch&&V(l)){var i={};if(i.id=c,i.funnel=l.group_type?l.group_type[Object.keys(l.group_type)[0]]:c,i.slug=c,i.name=l.name,i.thumbnail=l.thumbnail,i.template=null==Q?void 0:Q.id,i.pro=l.pro,i.group_type=l.group_type,i.type=H,i.preview=null==l?void 0:l.prevslug,t.push(i),l.group_type)Object.values(l.group_type).forEach((function(e){var t=M[H][r][e];n.push({id:null==t?void 0:t.prevslug,preview:X(0,t,r)})}));else n.push({id:null==l?void 0:l.prevslug,preview:X(0,l,r)})}}var o=M[H][r][K(null==Q?void 0:Q.id,H)];e.activeTemplate={thumbnail:K(null==Q?void 0:Q.id,H),preview:X(null==Q||Q.id,o,r),slug:K(null==Q?void 0:Q.id,H),name:null!=Q&&Q.id?M[H][r][null==Q?void 0:Q.id].name:"",pro:null!=Q&&Q.id?M[H][r][null==Q?void 0:Q.id].pro:"",tempPro:null!=Q&&Q.id?M[H][r][K(null==Q?void 0:Q.id,H,!("wc_checkout"!==H&&"optin"!==H||!R(Q.template))&&R(Q.template))].pro:"",group:H,filters:!!o.group_type&&Object.keys(o.group_type),type:H,funnelGroup:[H],prevId:o.prevslug},e.thumbnails=t,e.previews=n}catch(e){console.log("Failed to prepare template preview data:",e)}return e},funnelId:k&&N?N:_&&h?h:I,onImportComplete:g,templateFilterCheck:function(e,t){return"wc_checkout"===H?t===e.no_steps:"optin"!==H||(null===(n=e.group)||void 0===n?void 0:n.includes(t));var n},activeFilter:Y,showDefaultEditorNotice:!1,isStoreCheckout:_,parentRoute:Z,showTemplatesNav:!(k||_&&0===I),urlDependency:S,stepId:k,importApiPrefix:_?"store-checkout":"funnels"})}},366:function(e,t,n){"use strict";var r=n(0),c=n(2),a=n(1),l=n(8),i=n(406),o=n(14),s=n(291),u=n(59),b=n(20);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.step,n=e.requestCreateStep,d=e.onRequestClose,m=e.onCreationScreen,p=e.creationSuccess,O=e.clearAndCloseEverything,j=e.isBusy,v=e.errors,y=Object(b.b)(),w=y.isProFeatureLocked,g=y.isBasic,_=Object(b.b)("ck").isProFeatureLocked,h=g&&"wc_checkout"===(null==t?void 0:t.type)?_:w,E=f(Object(r.useState)(""),2),S=E[0],k=E[1],N=f(Object(r.useState)(""),2),C=N[0],P=N[1],A=f(Object(r.useState)(null),2),x=A[0],T=A[1],I=f(Object(r.useState)(null!=v?v:{}),2),D=I[0],F=I[1],B=f(Object(r.useState)("new"),2),L=B[0],z=B[1],U=f(Object(r.useState)(!1),2),M=U[0],R=U[1];Object(r.useEffect)((function(){F(v)}),[v]),Object(r.useEffect)((function(){var e;P(null==x||null===(e=x.step)||void 0===e?void 0:e.name),"new"===L&&Object(c.isEmpty)(S.trim())||"existing"===L&&Object(c.isEmpty)(C)?R(!0):R(!1)}),[L,x,S,C]);var q=function(){if(!M){var t=e.errors;x&&x.copyFrom&&!x.step&&(t.copyFrom=Object(a.__)("Copy From: This field is required","funnel-builder")),0===Object(c.size)(t)?n({copyFrom:x&&x.hasOwnProperty("step")?x.step:null,title:"existing"===L?"".concat(C," Copy"):S}):F(t)}};return Object(r.createElement)(r.Fragment,null,D&&Object(c.size)(D)>0&&Object(r.createElement)(u.a,{status:"error",isDismissible:!0,onRemove:function(){return F({})}},Object(r.createElement)("ul",{className:"bwf-m-0"},Object.keys(D).map((function(e){return Object(r.createElement)("li",{className:"bwf-m-0",key:e},D[e])})))),j||!m||p?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("form",{method:"post",action:"",className:"bwf-funnel-add-step",onSubmit:function(e){q(),e.preventDefault()}},Object(r.createElement)(s.a,{options:[{value:"new",label:Object(a.__)("Create New","funnel-builder")},{value:"existing",label:Object(a.__)("Clone Existing","funnel-builder"),isPro:h}],selected:L,onChange:function(e){z(e)},className:"bwf-add-bump_radio-items"}),"new"===L?Object(r.createElement)(l.TextControl,{label:Object(a.__)("Name","funnel-builder"),placeholder:Object(a.__)("Enter Name","funnel-builder"),value:S,onChange:function(e){return k(e)}}):null,"existing"===L?Object(r.createElement)(i.a,{step:t,onStepSelected:function(e){return T(e)},showCheckbox:!1}):null,Object(r.createElement)("div",{className:"".concat(isRtl?" wf_funnel_left_align":" wf_funnel_right_align")},Object(r.createElement)(o.a,{className:"bwf-modal-cancel-btn",onClick:d},Object(a.__)("Cancel","funnel-builder")),Object(r.createElement)(o.a,{isPrimary:!0,onClick:q,disabled:M,isBusy:j,className:M?"bwf-no-ripple":""},Object(a.__)("Add","funnel-builder"))))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-modal-content"},Object(r.createElement)("div",{style:{marginTop:"-16px"}},Object(a.__)("Something went wrong, Pleas contact to support team","funnel-builder"))),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"".concat(isRtl?"bwf-t-left":"bwf-t-right")},Object(r.createElement)(o.a,{isPrimary:!0,onClick:function(){d(),O()}},Object(a.__)("OK","funnel-builder")))))}},367:function(e,t,n){"use strict";var r=n(0),c=n(8),a=n(1),l=n(4),i=n(6),o=n.n(i),s=n(5),u=n(10),b=n.n(u),f=n(393),d=n(86);function m(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return j(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.isOpen,n=e.onRequestClose,i=p(Object(r.useState)({default_css:"",skin_all:{}}),2),u=i[0],O=i[1],j=p(Object(r.useState)(!0),2),v=j[0],y=j[1];return Object(r.useEffect)((function(){b()({path:Object(l.y)("/funnel-bump/skins/preview/")}).then((function(e){e.success&&O({skin_all:e.skin_all,default_css:e.default_css}),y(!1)})).catch((function(e){y(!1),console.log(e)}))}),[]),t&&Object(r.createElement)("div",{className:"bwf-order-bum-pro-modal"},Object(r.createElement)(c.Modal,{className:"bwf-admin-modal bwf-ob-pro-modal bwf-admin-modal-no-header",isDismissible:!1,onRequestClose:function(){return n()}},Object(r.createElement)("div",{className:"bwf-flex bwf--space-between bwf-modal-custom-header"},Object(r.createElement)("div",{className:"bwf-flex bwf--g8 bwf-modal-title"},Object(a.__)("Order Bump Templates","funnel-builder")),Object(r.createElement)("div",{className:"bwf-flex bwf--g16"},Object(r.createElement)(d.a,{isPrimary:!0,proLink:Object(l.U)(["Order","Bump","Template","Modal"])}),Object(r.createElement)("button",{className:"bwf-no-style-button",onClick:n},Object(r.createElement)(s.a,{icon:"cross",size:"24"})))),Object(r.createElement)("div",{className:o()("bwf-ob-pro-modal-content",{"is-placeholder":v}),style:{paddingTop:"1px"}},v?Object(r.createElement)("div",{className:"bwf-ob-lite-skins-wrap"},m(new Array(8)).map((function(e,t){return Object(r.createElement)(f.a,{index:t,key:"ob-place-".concat(t)})}))):Object(r.createElement)("div",{className:"bwf-ob-lite-skins-wrap",id:"wfob_wrap"},Object(r.createElement)("style",null,u.default_css),Object.keys(u.skin_all).map((function(e){var t=u.skin_all[e];return Object(r.createElement)("div",{className:"bwf_bump_skin_preview",key:e},Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:null==t?void 0:t.dynamic_inline_css}}),Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:null==t?void 0:t.html}}))}))," "))))}},393:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p}));var r=n(0),c=n(328),a=n(4),l=n(2),i=n(433),o=n(6),s=n.n(o),u={image:i.a},b=function(e,t,n,a){return e.map((function(e,i){return"richeditor"===e.type&&(e.openMergeTagModal=a,e.id="richeditor-".concat(i),e.toolbar="bold,italic, underline,alignleft,aligncenter,alignright,bullist,numlist,link,forecolor,fontsizeselect,mergetagmodal",e.quicktags=!0),Object(r.createElement)(r.Fragment,{key:i},(Object(l.isEmpty)(e.toggler)||f(t,e.toggler,e))&&Object(r.createElement)(c.a,{input:e,formProps:n(e.key),values:t,customMapField:u}))}))},f=function(e,t){var n=!1;try{var r;if(!e[t.key])return n;if(r=e[t.key],Array.isArray(t.value)&&Array.isArray(r)){for(var c=0;c<r.length;c++)if(t.value.indexOf(r[c])>-1){n=!0;break}}else Object(a.z)(r)==Object(a.z)(t.value)&&(n=!0)}catch(e){console.log("Toggler:",e),n=!1}return n},d=function(e,t){if(e.selectors&&e.stylekey&&!Object(l.isEmpty)(e.value)){var n,r=Array.isArray(e.selectors)?e.selectors.toString():e.selectors,c="".concat(e.stylekey,":").concat(e.value).concat(null!==(n=null==e?void 0:e.styleUnit)&&void 0!==n?n:"",";");-1!==t.search("".concat(r,"{"))?t=t.replace("".concat(r,"{"),"".concat(r,"{").concat(c)):t+="".concat(r,"{").concat(c,"}")}return t},m=function(e){return new Promise((function(t,n){var r="";e.forEach((function(e){switch(e.type){case"text":if(e.selectors){var t=Array.isArray(e.selectors)?e.selectors.toString():e.selectors;jQuery(t).html(e.value)}break;case"richtext":case"richeditor":case"textarea":if(e.selectors){var n=Array.isArray(e.selectors)?e.selectors.toString():e.selectors;jQuery(n).html(e.value)}break;case"label":break;case"toggle":case"checkbox":if(e.selectors){var c=Array.isArray(e.selectors)?e.selectors.toString():e.selectors;1==e.value||"true"==e.value?e.contentClass?jQuery(c).addClass(e.contentClass):jQuery(c).show():e.contentClass?jQuery(c).removeClass(e.contentClass):jQuery(c).hide()}break;case"select":if(e.selectors){var a=Array.isArray(e.selectors)?e.selectors.toString():e.selectors;if(e.value&&Object(l.isArray)(e.allClasses)?(jQuery(a).removeClass(e.allClasses),jQuery(a).addClass(e.value)):r=d(e,r),e.classList){var i=Object.values(e.classList),o=e.classList[e.value];jQuery(a).removeClass(i).addClass(o)}}break;case"color":if(e.selectors){var s=Array.isArray(e.selectors)?e.selectors.toString():e.selectors,u="".concat(e.stylekey,":").concat(e.value,";");r+="".concat(s,"{").concat(u,"}"),"social_proof_tooltip_bg_color"===e.key&&(r+="".concat(s,"::after{ border-top-color: ").concat(e.value,"}"))}if(e.isHover&&e.hoverSelectors){var b=Array.isArray(e.hoverSelectors)?e.hoverSelectors.toString():e.hoverSelectors,f="".concat(e.stylekey,":").concat(e.hoverVal,";");r+="".concat(b,"{").concat(f,"}")}break;case"dimension-control":if(e.selectors){var m=Array.isArray(e.selectors)?e.selectors.toString():e.selectors,p="".concat(e.stylekey,":").concat(e.value.toString().replace(/ /g,"px ")).concat(null==e?void 0:e.styleUnit,";");r+="".concat(m,"{").concat(p,"}"),r+="".concat(m,"{").concat(p,"}")}break;case"box-shadow":if(e.selectors){var O=e.value,j=O.h_offset,v=O.v_offset,y=O.blur,w=O.spread,g=O.color,_=Array.isArray(e.selectors)?e.selectors.toString():e.selectors;if(!(Object(l.isEmpty)(j)||Object(l.isEmpty)(v)||Object(l.isEmpty)(y)||Object(l.isEmpty)(w)||Object(l.isEmpty)(g))){var h="".concat(e.stylekey,":").concat(j,"px ").concat(v,"px ").concat(y,"px ").concat(w,"px ").concat(g,";");r+="".concat(_,"{").concat(h,"}")}}break;case"image":if(e.selectors){var E,S,k,N,C,P,A=Array.isArray(e.selectors)?e.selectors.toString():e.selectors;if("product"===e.value.type||"custom"===e.value.type&&Object(l.isEmpty)(null==e||null===(E=e.value)||void 0===E?void 0:E.custom_url))if(jQuery(A+" img").length)jQuery(A+" img").attr("src",null==e||null===(C=e.value)||void 0===C?void 0:C.image_url);else jQuery(A).find("svg").remove(),jQuery(A).append('<img src="'+(null==e||null===(P=e.value)||void 0===P?void 0:P.image_url)+'" alt="order bump" />');else if(Object(l.isEmpty)(null==e||null===(S=e.value)||void 0===S?void 0:S.custom_url))jQuery(A+" img").attr("src","").attr("srcset","");else{var x,T;if(jQuery(A+" img").length)jQuery(A+" img").attr("src",null==e||null===(x=e.value)||void 0===x?void 0:x.custom_url).attr("srcset","");else jQuery(A).find("svg").remove(),jQuery(A).append('<img src="'+(null==e||null===(T=e.value)||void 0===T?void 0:T.custom_url)+'" alt="order bump" />').attr("srcset","")}if(e.alignmentSelectors){var I,D,F=Array.isArray(e.alignmentSelectors)?e.alignmentSelectors.toString():e.alignmentSelectors,B=null!==(I=null==e||null===(D=e.value)||void 0===D?void 0:D.position)&&void 0!==I?I:"left";if(null!=e&&e.alignmentClassList){var L=Object.values(null==e?void 0:e.alignmentClassList),z=null==e?void 0:e.alignmentClassList[B];jQuery(F).removeClass(L).addClass(z)}}var U=null!==(k=null==e||null===(N=e.value)||void 0===N?void 0:N.width)&&void 0!==k?k:"100";U&&(r+="".concat(A,"{max-width: ").concat(U,"px;}"))}break;default:r=d(e,r)}})),t(r)}))},p=function(e){var t=e.index,n=void 0===t?0:t;return Object(r.createElement)("div",{className:s()("bwf-p-20 bwf-border-1 bwf-rounded-6",{"bwf-mt-16":0!==n||1!==n}),style:{background:"#ffffff"}},Object(r.createElement)("div",{className:"bwf-flex bwf--align-start bwf--g24"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-100 bwf-h-100 "}),Object(r.createElement)("div",{className:"bwf-flex bwf--column bwf--align-start",style:{width:"100%"}},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-210 bwf-h-15 bwf-mb-10"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-full bwf-h-12 bwf-mb-5"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-full bwf-h-12 bwf-mb-5"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-150 bwf-h-12 bwf-mb-5"})),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-w-100 bwf-h-30 bwf-mt-20"})))}},415:function(e,t,n){"use strict";var r=n(0),c=n(8),a=n(1),l=n(2),i=(n(489),n(14));function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.a=function(e){var t=e.pageUrl,n=e.onclose,s=e.title,u=e.updateDetail,b=e.isLoading,f=e.pageUrlSlug,d=o(Object(r.useState)(s),2),m=d[0],p=d[1],O=o(Object(r.useState)(f),2),j=O[0],v=O[1],y=o(Object(r.useState)(""),2),w=y[0],g=y[1],_=Object(l.isEmpty)(null==m?void 0:m.trim())||Object(l.isEmpty)(null==j?void 0:j.trim()),h=Object(r.useRef)();return Object(r.useEffect)((function(){var e,n=null==t?void 0:t.split("/");h.current=null==n||null===(e=n.slice(0,Object(l.isEmpty)(n[n.length-1])?-2:-1))||void 0===e?void 0:e.join("/"),g(t)}),[t]),Object(r.createElement)(c.Modal,{title:Object(a.__)("Edit Details","funnel-builder"),className:"bwf-admin-modal bwf-admin-modal-small bwf-edit-detail-modal",onRequestClose:function(){return n()},isDismissible:!0,shouldCloseOnClickOutside:!0},Object(r.createElement)("label",{id:"required"},Object(a.__)("Name","funnel-builder")),Object(r.createElement)(c.TextControl,{value:m,onChange:function(e){p(e)},className:Object(l.size)(null==m?void 0:m.trim())?"":"bwf-error-border",onKeyDown:function(e){if("Enter"===e.key){if(_)return;u(m,j)}}}),Object(l.size)(null==m?void 0:m.trim())?null:Object(r.createElement)("div",{style:{color:"#E15334",marginTop:"8px"}},Object(a.__)("Name is required","funnel-builder")),Object(r.createElement)("label",{id:"required",className:"bwf-mt-16"},Object(a.__)("Page URL Slug","funnel-builder")),Object(r.createElement)(c.TextControl,{value:j,onChange:function(e){v(e.replace(/\s+/g,"-").toLocaleLowerCase()),g(h.current+"/"+e.replace(/\s+/g,"-").toLowerCase().toLocaleLowerCase())},className:Object(l.size)(null==j?void 0:j.trim())?"":"bwf-error-border"}),Object(l.size)(null==j?void 0:j.trim())?null:Object(r.createElement)("div",{style:{color:"#E15334",marginTop:"8px"}},Object(a.__)("Page URL Slug is required","funnel-builder")),Object(r.createElement)("div",{className:"bwf-page-url"},Object(r.createElement)("label",{className:"bwf-url-title bwf-mt-16"},Object(a.__)("Page URL","funnel-builder")),Object(r.createElement)("div",{className:"bwf-copy-link"},Object(r.createElement)("span",{className:"bwf-code-copy"},w))),Object(r.createElement)("div",{className:"bwf-edit-detail-modal__actions"},Object(r.createElement)(i.a,{className:"bwf-modal-cancel-btn",onClick:n},Object(a.__)("Cancel","funnel-builder")),Object(r.createElement)(i.a,{isPrimary:!0,onClick:function(){return u(m,j)},disabled:_,isBusy:b,className:_?"bwf-no-ripple":""},Object(a.__)("Update","funnel-builder"))))}},433:function(e,t,n){"use strict";var r=n(0),c=n(6),a=n.n(c),l=n(2),i=n(8),o=n(43),s=n(1),u=n(288),b=(n(449),n(5));function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,c,a,l,i=[],o=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);o=!0);}catch(e){s=!0,c=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw c}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var v=[{label:Object(s.__)("Product","funnel-builder"),value:"product"},{label:Object(s.__)("Custom","funnel-builder"),value:"custom"}],y=function(e){var t,n=e.onChange,c=e.value,f=e.label,d=e.className,p=Object(o.useInstanceId)(y),j="inspector-bump-image-".concat(p),w=a()("components-bump-image",d),g=O(Object(r.useState)(c.type),2),_=g[0],h=g[1],E=O(Object(r.useState)(c.custom_url),2),S=E[0],k=E[1],N=Object(r.useRef)(document.body.classList.contains("modal-open")),C=function(e){n(e)},P=function(e,n){e.preventDefault(),t||((t=wp.media({title:"Media",library:{uploadedTo:console.log(wp.media.view.settings.post.id),type:"image"},button:{text:"Use this media"},multiple:!1})).on("select",(function(){var e=t.state().get("selection").first().toJSON();C(m(m({},c),{},{custom_url:e.url,type:"custom"})),k(e.url)})),t.on("close",(function(){N.current&&!document.body.classList.contains("modal-open")&&document.body.classList.add("modal-open")}))),t.open()};return Object(r.createElement)(i.BaseControl,{label:f,className:w,id:j},Object(r.createElement)("div",{className:"component-bump-image-wrap"},!Object(l.isEmpty)(v)&&Object(r.createElement)(i.ButtonGroup,{className:"bwf-button-group bwf-group-tab"},v.map((function(e,t){return Object(r.createElement)(i.Button,{key:t,variant:e.value===_?"primary":"",onClick:function(){h(e.value),"product"===e.value?(delete c.custom_url,C(m(m({},c),{},{type:e.value}))):Object(l.isEmpty)(S)||C(m(m({},c),{},{type:e.value,custom_url:S}))}},e.label)}))),Object(r.createElement)("div",{className:"bwf-bump-image-field"},Object(r.createElement)("div",{className:"bwf-bump-img-field-container"},"product"===_?Object(r.createElement)("img",{src:null==c?void 0:c.image_url,alt:"Product Image"}):Object(r.createElement)("div",{className:"bwf-bump-custom-img"},S?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("img",{src:S,alt:"Product Image"}),Object(r.createElement)("div",{className:"bwf-media-actions"},Object(r.createElement)("span",{className:"bwf-media-trigger bwf-trigger-delete",onClick:function(){k(""),C(m(m({},c),{},{type:"product",custom_url:""}))}},Object(r.createElement)(b.a,{icon:"delete",size:"16"})),Object(r.createElement)("span",{className:"bwf-media-trigger bwf-trigger-edit",onClick:P},Object(r.createElement)(b.a,{icon:"edit",size:"16"})))):Object(r.createElement)("div",{className:"bwf-media-uploader-wrap",onClick:P},Object(r.createElement)(b.a,{icon:"add-image",size:48}),Object(r.createElement)("div",null,Object(s.__)("Add Image","funnel-builder"))))),Object(r.createElement)("div",{className:"bwf-bump-image-attr"},Object(r.createElement)(i.TextControl,{type:"number",label:Object(s.__)("Width (px)","funnel-builder"),max:400,value:null==c?void 0:c.width,onChange:function(e){C(m(m({},c),{},{width:e}))}}),Object(r.createElement)(u.b,{label:Object(s.__)("Image Position","funnel-builder"),options:[{label:Object(s.__)("Left","funnel-builder"),key:"left",value:"left"},{label:Object(s.__)("Right","funnel-builder"),key:"right",value:"right"},{label:Object(s.__)("Top","funnel-builder"),key:"top",value:"top"}],selected:null==c?void 0:c.position,onChange:function(e){C(m(m({},c),{},{position:e}))}})))))};t.a=y},449:function(e,t,n){},489:function(e,t,n){},663:function(e,t,n){},664:function(e,t,n){},665:function(e,t,n){},666:function(e,t,n){},667:function(e,t,n){}}]);